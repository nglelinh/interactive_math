<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bubble Sort - Interactive Algorithm Visualization</title>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                packages: {'[+]': ['ams', 'newcommand', 'mathtools', 'bm']},
                macros: {
                    O: ['\\mathcal{O}'],
                    Theta: ['\\Theta'],
                    Omega: ['\\Omega']
                }
            }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
    <script src="../math-simple.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a3a 50%, #2d1b69 100%);
            color: white;
            line-height: 1.8;
            min-height: 100vh;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 40px;
            backdrop-filter: blur(10px);
        }

        h1 {
            text-align: center;
            font-size: 3.2em;
            margin-bottom: 30px;
            background: linear-gradient(45deg, #2ecc71, #3498db);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 700;
        }

        .lesson-nav {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            padding: 10px;
            flex-wrap: wrap;
        }

        .nav-button {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: none;
            padding: 12px 24px;
            margin: 5px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            font-weight: 500;
        }

        .nav-button:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .nav-button.active {
            background: linear-gradient(45deg, #2ecc71, #3498db);
            box-shadow: 0 4px 15px rgba(46, 204, 113, 0.3);
        }

        .lesson-section {
            display: none;
            animation: fadeIn 0.5s ease-in;
        }

        .lesson-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .introduction {
            background: rgba(46, 204, 113, 0.1);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            border-left: 5px solid #2ecc71;
        }

        .theory-section {
            background: rgba(255, 255, 255, 0.1);
            padding: 30px;
            border-radius: 15px;
            margin: 25px 0;
            border-left: 5px solid #3498db;
        }

        .visualization-area {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            padding: 30px;
            margin: 20px 0;
        }

        .array-container {
            display: flex;
            justify-content: center;
            align-items: flex-end;
            margin: 30px 0;
            height: 300px;
            gap: 5px;
            flex-wrap: wrap;
            align-content: flex-end;
        }

        .bar {
            background: linear-gradient(145deg, #3498db, #2980b9);
            border: 2px solid #2ecc71;
            border-radius: 4px 4px 0 0;
            color: white;
            font-weight: bold;
            font-size: 14px;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            min-width: 40px;
            display: flex;
            align-items: flex-end;
            justify-content: center;
            padding-bottom: 5px;
        }

        .bar.comparing {
            background: linear-gradient(145deg, #f39c12, #e67e22);
            border-color: #f39c12;
            transform: scale(1.05);
            box-shadow: 0 4px 20px rgba(243, 156, 18, 0.4);
        }

        .bar.swapping {
            background: linear-gradient(145deg, #e74c3c, #c0392b);
            border-color: #e74c3c;
            animation: swap 0.5s ease-in-out;
        }

        .bar.sorted {
            background: linear-gradient(145deg, #2ecc71, #27ae60);
            border-color: #2ecc71;
            box-shadow: 0 2px 10px rgba(46, 204, 113, 0.3);
        }

        .bar.current-pass {
            border-color: #9b59b6;
            border-width: 3px;
        }

        @keyframes swap {
            0%, 100% { transform: translateY(0) scale(1.05); }
            50% { transform: translateY(-20px) scale(1.1); }
        }

        .algorithm-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
            background: rgba(0, 0, 0, 0.2);
            padding: 20px;
            border-radius: 10px;
        }

        .stat-item {
            text-align: center;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
        }

        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #2ecc71;
        }

        .stat-label {
            font-size: 0.9em;
            color: #95a5a6;
        }

        .controls {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .control-group {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .control-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2ecc71;
        }

        input[type="range"] {
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: rgba(255, 255, 255, 0.2);
            outline: none;
            -webkit-appearance: none;
            appearance: none;
            margin: 8px 0;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: linear-gradient(45deg, #2ecc71, #3498db);
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(46, 204, 113, 0.3);
        }

        button {
            background: linear-gradient(45deg, #2ecc71, #27ae60);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
            margin: 5px;
            font-weight: 600;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(46, 204, 113, 0.3);
        }

        button.secondary {
            background: linear-gradient(45deg, #3498db, #2980b9);
        }

        button.secondary:hover {
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        }

        button:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
        }

        .complexity-box {
            background: rgba(52, 152, 219, 0.1);
            border: 2px solid #3498db;
            border-radius: 15px;
            padding: 25px;
            margin: 25px 0;
        }

        .example-box {
            background: rgba(241, 196, 15, 0.1);
            border-left: 4px solid #f1c40f;
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 10px 10px 0;
        }

        .code-block {
            background: rgba(0, 0, 0, 0.4);
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            margin: 15px 0;
            overflow-x: auto;
        }

        .algorithm-log {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            height: 200px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 12px;
        }

        .grid-layout {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin: 25px 0;
        }

        .pass-indicator {
            text-align: center;
            font-size: 1.2em;
            margin: 15px 0;
            padding: 10px;
            background: rgba(155, 89, 182, 0.2);
            border-radius: 8px;
            border: 1px solid #9b59b6;
        }

        @media (max-width: 768px) {
            .array-container {
                height: 200px;
            }
            
            .bar {
                min-width: 30px;
                font-size: 12px;
            }
            
            .controls {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>📊 Bubble Sort Algorithm</h1>
        
        <div class="lesson-nav">
            <button class="nav-button active" onclick="showSection('overview')">🎯 Overview</button>
            <button class="nav-button" onclick="showSection('algorithm')">⚙️ Algorithm</button>
            <button class="nav-button" onclick="showSection('complexity')">⚡ Complexity</button>
            <button class="nav-button" onclick="showSection('visualization')">📊 Visualization</button>
            <button class="nav-button" onclick="showSection('comparison')">🔄 Comparison</button>
            <button class="nav-button" onclick="showSection('optimization')">🚀 Optimization</button>
        </div>

        <!-- OVERVIEW SECTION -->
        <div id="overview" class="lesson-section active">
            <!-- Historical Section -->
            <div style="background: linear-gradient(135deg, #2d1b69 0%, #11998e 100%); padding: 25px; border-radius: 15px; margin-bottom: 30px; border: 2px solid rgba(255, 255, 255, 0.1);">
                <h2 style="color: #FFD700; text-align: center; margin-bottom: 25px;">📚 Lịch Sử Bubble Sort</h2>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                    <div style="background: rgba(255, 255, 255, 0.1); padding: 20px; border-radius: 10px;">
                        <h4 style="color: #00d4ff; margin-bottom: 15px;">📊 Nguồn gốc (1950s)</h4>
                        <p><strong>Thuật toán cổ điển:</strong> Bubble Sort là một trong những thuật toán sắp xếp đầu tiên được nghiên cứu trong khoa học máy tính. Tên gọi xuất phát từ cách các phần tử "nổi lên" như bong bóng nước.</p>
                    </div>
                    <div style="background: rgba(255, 255, 255, 0.1); padding: 20px; border-radius: 10px;">
                        <h4 style="color: #ff6b6b; margin-bottom: 15px;">🎓 Giá trị giáo dục</h4>
                        <p><strong>Công cụ học tập:</strong> Mặc dù không hiệu quả cho dữ liệu lớn, Bubble Sort vẫn được sử dụng rộng rãi trong giáo dục vì tính đơn giản và dễ hiểu.</p>
                    </div>
                </div>

                <div style="background: rgba(255, 215, 0, 0.1); padding: 20px; border-radius: 10px; margin: 20px 0;">
                    <h4 style="color: #FFD700; margin-bottom: 15px;">⚡ Tại sao vẫn quan trọng?</h4>
                    <ul style="color: #ffffff; line-height: 1.8;">
                        <li><strong>Tính trực quan:</strong> Dễ dàng hình dung và debug</li>
                        <li><strong>Stable sorting:</strong> Giữ nguyên thứ tự các phần tử bằng nhau</li>
                        <li><strong>Nền tảng lý thuyết:</strong> Giúp hiểu về complexity analysis</li>
                        <li><strong>Optimized variants:</strong> Cơ sở cho các thuật toán cải tiến</li>
                    </ul>
                </div>

                <div style="background: rgba(76, 175, 80, 0.15); padding: 20px; border-radius: 10px;">
                    <h4 style="color: #4caf50; margin-bottom: 15px;">🌟 Di sản</h4>
                    <p>Bubble Sort đại diện cho bước đầu tiên trong lịch sử phát triển các thuật toán sắp xếp, mở đường cho những thuật toán hiệu quả hơn như Quick Sort và Merge Sort.</p>
                </div>
            </div>
            
            <div class="introduction">
                <h2>🎯 Bubble Sort - The Classic Sorting Algorithm</h2>
                <p><strong>Bubble Sort</strong> is one of the simplest sorting algorithms to understand and implement. It repeatedly compares adjacent elements and swaps them if they're in the wrong order.</p>
                <p>🏆 <strong>Key Characteristics:</strong></p>
                <ul>
                    <li><strong>🔄 Comparison-based:</strong> Compares adjacent elements</li>
                    <li><strong>🔃 In-place:</strong> Sorts without extra space</li>
                    <li><strong>✅ Stable:</strong> Maintains relative order of equal elements</li>
                    <li><strong>🎓 Educational:</strong> Great for learning sorting concepts</li>
                </ul>
            </div>

            <div class="grid-layout">
                <div class="example-box">
                    <h3>✅ Advantages</h3>
                    <ul>
                        <li><strong>Simple Implementation:</strong> Easy to understand and code</li>
                        <li><strong>In-place Sorting:</strong> O(1) extra space</li>
                        <li><strong>Stable Algorithm:</strong> Preserves order of equal elements</li>
                        <li><strong>Adaptive:</strong> Performs better on nearly sorted arrays</li>
                        <li><strong>Educational Value:</strong> Great for teaching sorting concepts</li>
                    </ul>
                </div>

                <div class="example-box">
                    <h3>❌ Disadvantages</h3>
                    <ul>
                        <li><strong>Poor Performance:</strong> O(n²) time complexity</li>
                        <li><strong>Not Practical:</strong> Too slow for large datasets</li>
                        <li><strong>Many Comparisons:</strong> Always compares adjacent elements</li>
                        <li><strong>Many Swaps:</strong> Can perform up to n²/2 swaps</li>
                    </ul>
                </div>
            </div>

            <div class="visualization-area">
                <h3>📊 How Bubble Sort Works</h3>
                <p style="text-align: center; margin-bottom: 20px;">
                    Larger elements "bubble up" to their correct positions, like air bubbles rising in water.
                </p>
                
                <div class="array-container" id="demoArray">
                    <div class="bar" style="height: 64px;">64</div>
                    <div class="bar" style="height: 34px;">34</div>
                    <div class="bar" style="height: 25px;">25</div>
                    <div class="bar" style="height: 12px;">12</div>
                    <div class="bar" style="height: 22px;">22</div>
                    <div class="bar" style="height: 11px;">11</div>
                    <div class="bar" style="height: 90px;">90</div>
                </div>
                
                <p style="text-align: center; color: #95a5a6;">
                    Initial array: [64, 34, 25, 12, 22, 11, 90]<br>
                    The algorithm will compare adjacent pairs and swap if needed
                </p>
            </div>
        </div>

        <!-- ALGORITHM SECTION -->
        <div id="algorithm" class="lesson-section">
            <div class="theory-section">
                <h2>⚙️ Bubble Sort Algorithm</h2>
                
                <div class="example-box">
                    <h3>🔄 Algorithm Steps</h3>
                    <ol>
                        <li><strong>Pass 1:</strong> Compare adjacent elements, swap if left > right</li>
                        <li><strong>Bubble Up:</strong> Largest element moves to the end</li>
                        <li><strong>Pass 2:</strong> Repeat for remaining n-1 elements</li>
                        <li><strong>Continue:</strong> Until no swaps are needed</li>
                        <li><strong>Complete:</strong> Array is sorted</li>
                    </ol>
                </div>

                <div class="code-block">
// Basic Bubble Sort Implementation
void bubbleSort(int arr[], int n) {
    for (int i = 0; i < n - 1; i++) {
        // Last i elements are already sorted
        for (int j = 0; j < n - i - 1; j++) {
            // Compare adjacent elements
            if (arr[j] > arr[j + 1]) {
                // Swap if they're in wrong order
                swap(arr[j], arr[j + 1]);
            }
        }
    }
}
                </div>

                <div class="grid-layout">
                    <div class="complexity-box">
                        <h4>🔍 Detailed Analysis</h4>
                        <p><strong>Outer Loop:</strong> Runs n-1 times</p>
                        <p><strong>Inner Loop:</strong> Runs (n-1), (n-2), ..., 1 times</p>
                        <p><strong>Total Comparisons:</strong></p>
                        <div style="text-align: center; margin: 15px 0; font-size: 1.1em;">
                            $(n-1) + (n-2) + ... + 1 = \frac{n(n-1)}{2}$
                        </div>
                        <p><strong>Therefore:</strong> O(n²) comparisons</p>
                    </div>

                    <div class="complexity-box">
                        <h4>🎯 Pass-by-Pass Breakdown</h4>
                        <p><strong>Pass 1:</strong> n-1 comparisons, largest element moves to end</p>
                        <p><strong>Pass 2:</strong> n-2 comparisons, second largest bubbles up</p>
                        <p><strong>Pass k:</strong> n-k comparisons, kth largest in position</p>
                        <p><strong>Result:</strong> Each pass places one element correctly</p>
                    </div>
                </div>

                <div class="example-box">
                    <h3>📝 Trace Example: [64, 34, 25, 12, 22, 11, 90]</h3>
                    <div class="code-block">
Pass 1: [64,34,25,12,22,11,90] → [34,64,25,12,22,11,90] → [34,25,64,12,22,11,90] 
        → [34,25,12,64,22,11,90] → [34,25,12,22,64,11,90] → [34,25,12,22,11,64,90] 
        → [34,25,12,22,11,64,90] (90 is in place)

Pass 2: [34,25,12,22,11,64] → [25,34,12,22,11,64] → [25,12,34,22,11,64] 
        → [25,12,22,34,11,64] → [25,12,22,11,34,64] (64 is in place)

Pass 3: [25,12,22,11,34] → [12,25,22,11,34] → [12,22,25,11,34] 
        → [12,22,11,25,34] (34 is in place)

... continues until sorted
                    </div>
                </div>
            </div>
        </div>

        <!-- COMPLEXITY SECTION -->
        <div id="complexity" class="lesson-section">
            <div class="theory-section">
                <h2>⚡ Complexity Analysis</h2>

                <div class="grid-layout">
                    <div class="complexity-box">
                        <h3>⏱️ Time Complexity</h3>
                        <div style="text-align: center; margin: 20px 0;">
                            <div style="font-size: 1.5em; margin: 10px 0;">
                                <strong>Best Case:</strong> $\Omega(n)$
                            </div>
                            <p>Array is already sorted - optimized version</p>
                            
                            <div style="font-size: 1.5em; margin: 10px 0;">
                                <strong>Average Case:</strong> $\Theta(n^2)$
                            </div>
                            <p>Random order elements</p>
                            
                            <div style="font-size: 1.5em; margin: 10px 0;">
                                <strong>Worst Case:</strong> $\O(n^2)$
                            </div>
                            <p>Array sorted in reverse order</p>
                        </div>
                    </div>

                    <div class="complexity-box">
                        <h3>💾 Space Complexity</h3>
                        <div style="text-align: center; margin: 20px 0;">
                            <div style="font-size: 1.5em; margin: 10px 0;">
                                <strong>Space:</strong> $\O(1)$
                            </div>
                            <p>In-place sorting algorithm</p>
                            <p>Only uses constant extra space for variables</p>
                        </div>
                    </div>
                </div>

                <div class="example-box">
                    <h3>🔢 Mathematical Analysis</h3>
                    <p><strong>Number of Comparisons:</strong></p>
                    <div style="text-align: center; margin: 15px 0; font-size: 1.1em;">
                        $\sum_{i=1}^{n-1} i = \frac{n(n-1)}{2} = \frac{n^2 - n}{2}$
                    </div>
                    
                    <p><strong>Number of Swaps (Worst Case):</strong></p>
                    <div style="text-align: center; margin: 15px 0; font-size: 1.1em;">
                        Same as comparisons: $\frac{n(n-1)}{2}$
                    </div>
                    
                    <p><strong>For large n:</strong> Dominated by n² term, hence O(n²)</p>
                </div>

                <div class="algorithm-stats">
                    <div class="stat-item">
                        <div class="stat-value">O(n²)</div>
                        <div class="stat-label">Time Complexity</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">O(1)</div>
                        <div class="stat-label">Space Complexity</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">Yes</div>
                        <div class="stat-label">Stable</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">Yes</div>
                        <div class="stat-label">In-place</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- VISUALIZATION SECTION -->
        <div id="visualization" class="lesson-section">
            <div class="visualization-area">
                <h3>📊 Interactive Bubble Sort Visualization</h3>
                
                <div class="pass-indicator" id="passIndicator">
                    Ready to sort! Click 'Start Sorting' to begin
                </div>

                <div class="array-container" id="sortingArray">
                    <!-- Bars will be generated here -->
                </div>

                <div class="algorithm-stats" id="algorithmStats">
                    <div class="stat-item">
                        <div class="stat-value" id="comparisons">0</div>
                        <div class="stat-label">Comparisons</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="swaps">0</div>
                        <div class="stat-label">Swaps</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="currentPass">0</div>
                        <div class="stat-label">Current Pass</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="arrayAccesses">0</div>
                        <div class="stat-label">Array Accesses</div>
                    </div>
                </div>

                <div class="controls">
                    <div class="control-group">
                        <label>Array Size: <span id="arraySizeValue">10</span></label>
                        <input type="range" id="arraySize" min="5" max="20" value="10" onchange="updateArraySize()">
                        <button onclick="generateRandomArray()">🎲 Random Array</button>
                        <button onclick="generateSortedArray()">📊 Sorted Array</button>
                        <button onclick="generateReversedArray()">🔄 Reversed Array</button>
                    </div>

                    <div class="control-group">
                        <label>Speed Control: <span id="speedValue">Medium</span></label>
                        <input type="range" id="animationSpeed" min="1" max="5" value="3" onchange="updateSpeed()">
                        <button onclick="startSorting()" id="sortButton">▶️ Start Sorting</button>
                        <button onclick="pauseSorting()" id="pauseButton" disabled>⏸️ Pause</button>
                        <button onclick="resetArray()" id="resetButton">🔄 Reset</button>
                    </div>

                    <div class="control-group">
                        <label>Manual Control:</label>
                        <button onclick="stepForward()" id="stepButton" disabled>⏭️ Next Step</button>
                        <button onclick="finishSorting()" id="finishButton" disabled>⏩ Finish</button>
                    </div>
                </div>

                <div class="algorithm-log" id="algorithmLog">
                    <strong>Algorithm Log:</strong><br>
                    Ready to start bubble sort visualization...
                </div>
            </div>
        </div>

        <!-- COMPARISON SECTION -->
        <div id="comparison" class="lesson-section">
            <div class="theory-section">
                <h2>🔄 Bubble Sort vs Other Algorithms</h2>

                <div class="comparison-table" style="overflow-x: auto; margin: 25px 0;">
                    <table style="width: 100%; border-collapse: collapse; background: rgba(255, 255, 255, 0.1); border-radius: 10px; overflow: hidden;">
                        <tr style="background: rgba(0, 0, 0, 0.3);">
                            <th style="padding: 15px; border-bottom: 1px solid rgba(255, 255, 255, 0.1); color: #2ecc71;">Algorithm</th>
                            <th style="padding: 15px; border-bottom: 1px solid rgba(255, 255, 255, 0.1);">Best Case</th>
                            <th style="padding: 15px; border-bottom: 1px solid rgba(255, 255, 255, 0.1);">Average Case</th>
                            <th style="padding: 15px; border-bottom: 1px solid rgba(255, 255, 255, 0.1);">Worst Case</th>
                            <th style="padding: 15px; border-bottom: 1px solid rgba(255, 255, 255, 0.1);">Space</th>
                            <th style="padding: 15px; border-bottom: 1px solid rgba(255, 255, 255, 0.1);">Stable</th>
                        </tr>
                        <tr>
                            <td style="padding: 15px; border-bottom: 1px solid rgba(255, 255, 255, 0.1); font-weight: bold;">Bubble Sort</td>
                            <td style="padding: 15px; border-bottom: 1px solid rgba(255, 255, 255, 0.1);">O(n)</td>
                            <td style="padding: 15px; border-bottom: 1px solid rgba(255, 255, 255, 0.1);">O(n²)</td>
                            <td style="padding: 15px; border-bottom: 1px solid rgba(255, 255, 255, 0.1);">O(n²)</td>
                            <td style="padding: 15px; border-bottom: 1px solid rgba(255, 255, 255, 0.1);">O(1)</td>
                            <td style="padding: 15px; border-bottom: 1px solid rgba(255, 255, 255, 0.1);">Yes</td>
                        </tr>
                        <tr>
                            <td style="padding: 15px; border-bottom: 1px solid rgba(255, 255, 255, 0.1);">Selection Sort</td>
                            <td style="padding: 15px; border-bottom: 1px solid rgba(255, 255, 255, 0.1);">O(n²)</td>
                            <td style="padding: 15px; border-bottom: 1px solid rgba(255, 255, 255, 0.1);">O(n²)</td>
                            <td style="padding: 15px; border-bottom: 1px solid rgba(255, 255, 255, 0.1);">O(n²)</td>
                            <td style="padding: 15px; border-bottom: 1px solid rgba(255, 255, 255, 0.1);">O(1)</td>
                            <td style="padding: 15px; border-bottom: 1px solid rgba(255, 255, 255, 0.1);">No</td>
                        </tr>
                        <tr>
                            <td style="padding: 15px; border-bottom: 1px solid rgba(255, 255, 255, 0.1);">Insertion Sort</td>
                            <td style="padding: 15px; border-bottom: 1px solid rgba(255, 255, 255, 0.1);">O(n)</td>
                            <td style="padding: 15px; border-bottom: 1px solid rgba(255, 255, 255, 0.1);">O(n²)</td>
                            <td style="padding: 15px; border-bottom: 1px solid rgba(255, 255, 255, 0.1);">O(n²)</td>
                            <td style="padding: 15px; border-bottom: 1px solid rgba(255, 255, 255, 0.1);">O(1)</td>
                            <td style="padding: 15px; border-bottom: 1px solid rgba(255, 255, 255, 0.1);">Yes</td>
                        </tr>
                        <tr>
                            <td style="padding: 15px; border-bottom: 1px solid rgba(255, 255, 255, 0.1);">Merge Sort</td>
                            <td style="padding: 15px; border-bottom: 1px solid rgba(255, 255, 255, 0.1);">O(n log n)</td>
                            <td style="padding: 15px; border-bottom: 1px solid rgba(255, 255, 255, 0.1);">O(n log n)</td>
                            <td style="padding: 15px; border-bottom: 1px solid rgba(255, 255, 255, 0.1);">O(n log n)</td>
                            <td style="padding: 15px; border-bottom: 1px solid rgba(255, 255, 255, 0.1);">O(n)</td>
                            <td style="padding: 15px; border-bottom: 1px solid rgba(255, 255, 255, 0.1);">Yes</td>
                        </tr>
                        <tr>
                            <td style="padding: 15px;">Quick Sort</td>
                            <td style="padding: 15px;">O(n log n)</td>
                            <td style="padding: 15px;">O(n log n)</td>
                            <td style="padding: 15px;">O(n²)</td>
                            <td style="padding: 15px;">O(log n)</td>
                            <td style="padding: 15px;">No</td>
                        </tr>
                    </table>
                </div>

                <div class="grid-layout">
                    <div class="example-box">
                        <h3>📊 When to Use Bubble Sort</h3>
                        <ul>
                            <li><strong>Educational purposes:</strong> Teaching sorting concepts</li>
                            <li><strong>Very small datasets:</strong> n < 20</li>
                            <li><strong>Nearly sorted data:</strong> With optimization</li>
                            <li><strong>Simple implementation needed:</strong> Few lines of code</li>
                            <li><strong>Memory is extremely limited:</strong> O(1) space</li>
                        </ul>
                    </div>

                    <div class="example-box">
                        <h3>🚫 When NOT to Use Bubble Sort</h3>
                        <ul>
                            <li><strong>Large datasets:</strong> n > 100</li>
                            <li><strong>Performance critical applications:</strong> Too slow</li>
                            <li><strong>Production systems:</strong> Use efficient algorithms</li>
                            <li><strong>Real-time systems:</strong> Unpredictable worst case</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- OPTIMIZATION SECTION -->
        <div id="optimization" class="lesson-section">
            <div class="theory-section">
                <h2>🚀 Bubble Sort Optimizations</h2>

                <div class="example-box">
                    <h3>💡 Optimization 1: Early Termination</h3>
                    <p>If no swaps occur in a pass, the array is already sorted.</p>
                    <div class="code-block">
// Optimized Bubble Sort - Early termination
void optimizedBubbleSort(int arr[], int n) {
    for (int i = 0; i < n - 1; i++) {
        bool swapped = false;
        
        for (int j = 0; j < n - i - 1; j++) {
            if (arr[j] > arr[j + 1]) {
                swap(arr[j], arr[j + 1]);
                swapped = true;
            }
        }
        
        // If no swapping occurred, array is sorted
        if (!swapped) {
            break;
        }
    }
}
                    </div>
                    <p><strong>Improvement:</strong> Best case becomes O(n) instead of O(n²)</p>
                </div>

                <div class="example-box">
                    <h3>🎯 Optimization 2: Cocktail Shaker Sort</h3>
                    <p>Sort in both directions - bubbling largest up and smallest down.</p>
                    <div class="code-block">
// Cocktail Shaker Sort (Bidirectional Bubble Sort)
void cocktailSort(int arr[], int n) {
    bool swapped = true;
    int start = 0;
    int end = n - 1;
    
    while (swapped) {
        swapped = false;
        
        // Forward pass
        for (int i = start; i < end; i++) {
            if (arr[i] > arr[i + 1]) {
                swap(arr[i], arr[i + 1]);
                swapped = true;
            }
        }
        end--;
        
        if (!swapped) break;
        swapped = false;
        
        // Backward pass
        for (int i = end; i > start; i--) {
            if (arr[i] < arr[i - 1]) {
                swap(arr[i], arr[i - 1]);
                swapped = true;
            }
        }
        start++;
    }
}
                    </div>
                    <p><strong>Improvement:</strong> Better performance on certain input patterns</p>
                </div>

                <div class="grid-layout">
                    <div class="complexity-box">
                        <h4>📈 Performance Comparison</h4>
                        <p><strong>Standard Bubble Sort:</strong></p>
                        <ul>
                            <li>Best: O(n²)</li>
                            <li>Average: O(n²)</li>
                            <li>Worst: O(n²)</li>
                        </ul>
                        
                        <p><strong>Optimized Bubble Sort:</strong></p>
                        <ul>
                            <li>Best: O(n)</li>
                            <li>Average: O(n²)</li>
                            <li>Worst: O(n²)</li>
                        </ul>
                    </div>

                    <div class="complexity-box">
                        <h4>🎪 Real-world Applications</h4>
                        <p>While bubble sort is rarely used in production:</p>
                        <ul>
                            <li><strong>GPU sorting:</strong> Simple parallel implementation</li>
                            <li><strong>Embedded systems:</strong> Low memory requirements</li>
                            <li><strong>Teaching:</strong> Algorithm visualization</li>
                            <li><strong>Interview questions:</strong> Basic sorting understanding</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables for visualization
        let sortingArray = [];
        let isAnimating = false;
        let isPaused = false;
        let currentI = 0;
        let currentJ = 0;
        let animationSpeed = 500;
        let stats = {
            comparisons: 0,
            swaps: 0,
            currentPass: 0,
            arrayAccesses: 0
        };

        // Show/hide sections
        function showSection(sectionId) {
            const sections = document.querySelectorAll('.lesson-section');
            sections.forEach(section => section.classList.remove('active'));
            
            const buttons = document.querySelectorAll('.nav-button');
            buttons.forEach(button => button.classList.remove('active'));
            
            document.getElementById(sectionId).classList.add('active');
            event.target.classList.add('active');

            if (sectionId === 'visualization') {
                generateRandomArray();
            }
        }

        // Update array size display
        function updateArraySize() {
            const size = document.getElementById('arraySize').value;
            document.getElementById('arraySizeValue').textContent = size;
            generateRandomArray();
        }

        // Update animation speed
        function updateSpeed() {
            const speed = document.getElementById('animationSpeed').value;
            const speeds = ['Very Slow', 'Slow', 'Medium', 'Fast', 'Very Fast'];
            const delays = [1000, 750, 500, 250, 100];
            
            document.getElementById('speedValue').textContent = speeds[speed - 1];
            animationSpeed = delays[speed - 1];
        }

        // Generate arrays
        function generateRandomArray() {
            const size = parseInt(document.getElementById('arraySize').value);
            sortingArray = [];
            
            for (let i = 0; i < size; i++) {
                sortingArray.push(Math.floor(Math.random() * 200) + 10);
            }
            
            renderArray();
            resetStats();
            logMessage('Generated random array: [' + sortingArray.join(', ') + ']');
        }

        function generateSortedArray() {
            const size = parseInt(document.getElementById('arraySize').value);
            sortingArray = [];
            
            for (let i = 0; i < size; i++) {
                sortingArray.push((i + 1) * 15 + 10);
            }
            
            renderArray();
            resetStats();
            logMessage('Generated sorted array: [' + sortingArray.join(', ') + ']');
        }

        function generateReversedArray() {
            const size = parseInt(document.getElementById('arraySize').value);
            sortingArray = [];
            
            for (let i = size; i > 0; i--) {
                sortingArray.push(i * 15 + 10);
            }
            
            renderArray();
            resetStats();
            logMessage('Generated reverse sorted array: [' + sortingArray.join(', ') + ']');
        }

        // Render array visualization
        function renderArray() {
            const container = document.getElementById('sortingArray');
            container.innerHTML = '';
            
            const maxValue = Math.max(...sortingArray);
            const maxHeight = 250;
            
            sortingArray.forEach((value, index) => {
                const bar = document.createElement('div');
                bar.className = 'bar';
                bar.style.height = `${(value / maxValue) * maxHeight}px`;
                bar.textContent = value;
                bar.id = `bar-${index}`;
                container.appendChild(bar);
            });
        }

        // Reset statistics
        function resetStats() {
            stats = {
                comparisons: 0,
                swaps: 0,
                currentPass: 0,
                arrayAccesses: 0
            };
            updateStatsDisplay();
        }

        // Update statistics display
        function updateStatsDisplay() {
            document.getElementById('comparisons').textContent = stats.comparisons;
            document.getElementById('swaps').textContent = stats.swaps;
            document.getElementById('currentPass').textContent = stats.currentPass;
            document.getElementById('arrayAccesses').textContent = stats.arrayAccesses;
        }

        // Highlight bars
        function highlightBars(indices, className = 'comparing') {
            // Remove all highlights
            document.querySelectorAll('.bar').forEach(bar => {
                bar.classList.remove('comparing', 'swapping', 'current-pass');
            });
            
            // Add new highlights
            indices.forEach(index => {
                const bar = document.getElementById(`bar-${index}`);
                if (bar) bar.classList.add(className);
            });
        }

        // Swap animation
        async function animateSwap(i, j) {
            return new Promise(resolve => {
                highlightBars([i, j], 'swapping');
                
                setTimeout(() => {
                    // Swap array elements
                    [sortingArray[i], sortingArray[j]] = [sortingArray[j], sortingArray[i]];
                    
                    // Re-render array
                    renderArray();
                    
                    // Update stats
                    stats.swaps++;
                    stats.arrayAccesses += 4; // 2 reads + 2 writes
                    updateStatsDisplay();
                    
                    resolve();
                }, animationSpeed / 2);
            });
        }

        // Main sorting animation
        async function bubbleSortAnimation() {
            const n = sortingArray.length;
            let swapped;
            
            for (let i = 0; i < n - 1 && !isPaused; i++) {
                swapped = false;
                stats.currentPass = i + 1;
                updateStatsDisplay();
                
                document.getElementById('passIndicator').textContent = 
                    `Pass ${i + 1}: Bubbling up the ${getOrdinal(i + 1)} largest element`;
                
                logMessage(`Starting pass ${i + 1}`);
                
                for (let j = 0; j < n - i - 1 && !isPaused; j++) {
                    // Highlight comparison
                    highlightBars([j, j + 1], 'comparing');
                    
                    // Update stats
                    stats.comparisons++;
                    stats.arrayAccesses += 2; // 2 reads for comparison
                    updateStatsDisplay();
                    
                    logMessage(`Comparing ${sortingArray[j]} and ${sortingArray[j + 1]}`);
                    
                    await new Promise(resolve => setTimeout(resolve, animationSpeed));
                    
                    if (sortingArray[j] > sortingArray[j + 1]) {
                        logMessage(`${sortingArray[j]} > ${sortingArray[j + 1]}, swapping...`);
                        await animateSwap(j, j + 1);
                        swapped = true;
                    } else {
                        logMessage(`${sortingArray[j]} ≤ ${sortingArray[j + 1]}, no swap needed`);
                    }
                }
                
                // Mark sorted elements
                markSorted(n - i - 1);
                
                // Early termination optimization
                if (!swapped) {
                    logMessage('No swaps in this pass - array is sorted!');
                    break;
                }
            }
            
            // Mark all as sorted
            for (let k = 0; k < n; k++) {
                markSorted(k);
            }
            
            document.getElementById('passIndicator').textContent = 
                '✅ Sorting complete! Array is now sorted.';
            
            logMessage('🎉 Bubble sort completed!');
            
            // Re-enable controls
            isAnimating = false;
            document.getElementById('sortButton').disabled = false;
            document.getElementById('pauseButton').disabled = true;
            document.getElementById('resetButton').disabled = false;
            document.getElementById('stepButton').disabled = true;
            document.getElementById('finishButton').disabled = true;
        }

        // Mark element as sorted
        function markSorted(index) {
            const bar = document.getElementById(`bar-${index}`);
            if (bar) {
                bar.classList.remove('comparing', 'swapping');
                bar.classList.add('sorted');
            }
        }

        // Get ordinal number
        function getOrdinal(num) {
            const suffixes = ['th', 'st', 'nd', 'rd'];
            const v = num % 100;
            return num + (suffixes[(v - 20) % 10] || suffixes[v] || suffixes[0]);
        }

        // Control functions
        function startSorting() {
            if (!isAnimating) {
                isAnimating = true;
                isPaused = false;
                
                document.getElementById('sortButton').disabled = true;
                document.getElementById('pauseButton').disabled = false;
                document.getElementById('resetButton').disabled = true;
                document.getElementById('stepButton').disabled = true;
                document.getElementById('finishButton').disabled = false;
                
                bubbleSortAnimation();
            }
        }

        function pauseSorting() {
            isPaused = true;
            isAnimating = false;
            
            document.getElementById('sortButton').disabled = false;
            document.getElementById('pauseButton').disabled = true;
            document.getElementById('stepButton').disabled = false;
        }

        function resetArray() {
            isPaused = true;
            isAnimating = false;
            currentI = 0;
            currentJ = 0;
            
            generateRandomArray();
            
            document.getElementById('sortButton').disabled = false;
            document.getElementById('pauseButton').disabled = true;
            document.getElementById('resetButton').disabled = false;
            document.getElementById('stepButton').disabled = true;
            document.getElementById('finishButton').disabled = true;
            
            document.getElementById('passIndicator').textContent = 
                'Ready to sort! Click "Start Sorting" to begin';
        }

        function finishSorting() {
            // Sort instantly without animation
            sortingArray.sort((a, b) => a - b);
            renderArray();
            
            // Mark all as sorted
            for (let i = 0; i < sortingArray.length; i++) {
                markSorted(i);
            }
            
            document.getElementById('passIndicator').textContent = 
                '⚡ Sorting completed instantly!';
            
            logMessage('⚡ Sorting finished instantly');
            
            // Reset controls
            isAnimating = false;
            isPaused = false;
            document.getElementById('sortButton').disabled = false;
            document.getElementById('pauseButton').disabled = true;
            document.getElementById('resetButton').disabled = false;
            document.getElementById('stepButton').disabled = true;
            document.getElementById('finishButton').disabled = true;
        }

        // Log messages
        function logMessage(message) {
            const log = document.getElementById('algorithmLog');
            const timestamp = new Date().toLocaleTimeString();
            log.innerHTML += `<br>[${timestamp}] ${message}`;
            log.scrollTop = log.scrollHeight;
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', () => {
            generateRandomArray();
            updateSpeed();
        });
    </script>
</body>
</html>
