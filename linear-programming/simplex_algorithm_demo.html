<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Demo Thu·∫≠t To√°n Simplex - B·∫£ng Tableau</title>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
  <script src="../math-simple.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1600px;
            margin: 0 auto;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 30px;
        }
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 10px;
        }
        .subtitle {
            text-align: center;
            color: #7f8c8d;
            margin-bottom: 30px;
            font-style: italic;
        }
        .main-content {
            display: flex;
            gap: 30px;
        }
        .input-section {
            flex: 1;
            max-width: 400px;
        }
        .tableau-section {
            flex: 2;
        }
        .section {
            background-color: #ecf0f1;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .section h3 {
            margin: 0 0 15px 0;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 5px;
        }
        .input-group {
            margin-bottom: 15px;
        }
        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #2c3e50;
        }
        .input-row {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 10px;
        }
        .input-row input {
            width: 60px;
            padding: 5px;
            border: 1px solid #bdc3c7;
            border-radius: 3px;
            text-align: center;
        }
        .input-row select {
            padding: 5px;
            border: 1px solid #bdc3c7;
            border-radius: 3px;
        }
        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            margin: 5px 5px 5px 0;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #2980b9;
        }
        button.danger {
            background-color: #e74c3c;
        }
        button.danger:hover {
            background-color: #c0392b;
        }
        button.success {
            background-color: #27ae60;
        }
        button.success:hover {
            background-color: #229954;
        }
        button:disabled {
            background-color: #95a5a6;
            cursor: not-allowed;
        }
        .tableau-container {
            overflow-x: auto;
            margin-bottom: 20px;
        }
        .tableau {
            border-collapse: collapse;
            margin: 0 auto;
            background-color: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .tableau th, .tableau td {
            border: 1px solid #bdc3c7;
            padding: 8px 12px;
            text-align: center;
            font-family: 'Courier New', monospace;
        }
        .tableau th {
            background-color: #34495e;
            color: white;
            font-weight: bold;
        }
        .tableau .basic-var {
            background-color: #3498db;
            color: white;
            font-weight: bold;
        }
        .tableau .pivot-cell {
            background-color: #e74c3c !important;
            color: white;
            font-weight: bold;
            animation: pulse 1s infinite;
        }
        .tableau .pivot-row {
            background-color: #f8d7da;
        }
        .tableau .pivot-col {
            background-color: #d1ecf1;
        }
        .tableau .entering-var {
            background-color: #d4edda;
        }
        .tableau .leaving-var {
            background-color: #fff3cd;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        .iteration-info {
            background-color: #3498db;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: bold;
        }
        .step-info {
            background-color: #f39c12;
            color: white;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 15px;
            font-size: 14px;
        }
        .solution-info {
            background-color: #27ae60;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .error-info {
            background-color: #e74c3c;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .controls {
            text-align: center;
            margin-bottom: 20px;
        }
        .problem-display {
            background-color: #9b59b6;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            font-family: 'Courier New', monospace;
        }
        .constraint-list {
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid #bdc3c7;
            border-radius: 3px;
            padding: 10px;
            background-color: white;
        }
        .constraint-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 5px 0;
            border-bottom: 1px solid #ecf0f1;
        }
        .constraint-item:last-child {
            border-bottom: none;
        }
        .constraint-text {
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }
        .ratio-test {
            margin-top: 10px;
            padding: 10px;
            background-color: #e8f5e8;
            border-radius: 5px;
            border-left: 4px solid #27ae60;
        }
        .ratio-test h4 {
            margin: 0 0 10px 0;
            color: #27ae60;
        }
        .instructions {
            background-color: #f39c12;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            font-size: 14px;
            line-height: 1.4;
        }
    </style>





</head>
<body>
    <div class="container">
        <h1>Demo Thu·∫≠t To√°n Simplex</h1>
        <p class="subtitle">Gi·∫£i b√†i to√°n Linear Programming b·∫±ng ph∆∞∆°ng ph√°p Simplex v·ªõi b·∫£ng tableau</p>
        
        <!-- Historical Section -->
        <div style="background: linear-gradient(135deg, #2d1b69 0%, #11998e 100%); color: white; padding: 25px; border-radius: 15px; margin-bottom: 30px; border: 2px solid rgba(255, 255, 255, 0.1);">
            <h2 style="color: #FFD700; text-align: center; margin-bottom: 25px;">üìö L·ªãch S·ª≠ Thu·∫≠t To√°n Simplex</h2>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                <div style="background: rgba(255, 255, 255, 0.1); padding: 20px; border-radius: 10px;">
                    <h4 style="color: #00d4ff; margin-bottom: 15px;">üßÆ George Dantzig (1914-2005)</h4>
                    <p><strong>Ph√°t minh Simplex (1947):</strong> Dantzig ph√°t tri·ªÉn thu·∫≠t to√°n Simplex khi l√†m vi·ªác cho L·ª±c l∆∞·ª£ng Kh√¥ng qu√¢n M·ªπ, gi·∫£i quy·∫øt c√°c b√†i to√°n logistics trong Th·∫ø chi·∫øn II.</p>
                    <p><strong>√ù t∆∞·ªüng c·ªët l√µi:</strong> Di chuy·ªÉn t·ª´ ƒë·ªânh n√†y sang ƒë·ªânh kh√°c c·ªßa ƒëa di·ªán kh·∫£ thi ƒë·ªÉ t√¨m nghi·ªám t·ªëi ∆∞u.</p>
                </div>
                <div style="background: rgba(255, 255, 255, 0.1); padding: 20px; border-radius: 10px;">
                    <h4 style="color: #ff6b6b; margin-bottom: 15px;">‚öîÔ∏è B·ªëi c·∫£nh l·ªãch s·ª≠</h4>
                    <p><strong>Th·∫ø chi·∫øn II:</strong> Nhu c·∫ßu t·ªëi ∆∞u h√≥a logistics qu√¢n s·ª± - ph√¢n b·ªï t√†u, m√°y bay, l∆∞∆°ng th·ª±c m·ªôt c√°ch hi·ªáu qu·∫£ nh·∫•t.</p>
                    <p><strong>M√£ h√≥a:</strong> Thu·∫≠t to√°n ƒë∆∞·ª£c gi·ªØ b√≠ m·∫≠t qu√¢n s·ª± ƒë·∫øn nƒÉm 1947.</p>
                </div>
            </div>

            <div style="background: rgba(255, 215, 0, 0.1); padding: 20px; border-radius: 10px; margin: 20px 0;">
                <h4 style="color: #FFD700; margin-bottom: 15px;">‚ö° T√°c ƒë·ªông l·ªãch s·ª≠</h4>
                <ul style="color: #ffffff; line-height: 1.8;">
                    <li><strong>1975:</strong> Dantzig nh·∫≠n gi·∫£i th∆∞·ªüng Von Neumann cho "ph√°t minh c∆° b·∫£n nh·∫•t trong to√°n h·ªçc ·ª©ng d·ª•ng"</li>
                    <li><strong>Hi·ªán ƒë·∫°i:</strong> N·ªÅn t·∫£ng cho h·∫ßu h·∫øt c√°c solver LP th∆∞∆°ng m·∫°i</li>
                    <li><strong>·ª®ng d·ª•ng:</strong> T·ª´ t·ªëi ∆∞u h√≥a chu·ªói cung ·ª©ng ƒë·∫øn machine learning</li>
                </ul>
            </div>

            <div style="background: rgba(76, 175, 80, 0.15); padding: 20px; border-radius: 10px;">
                <h4 style="color: #4caf50; margin-bottom: 15px;">üåü Di s·∫£n</h4>
                <p>Thu·∫≠t to√°n Simplex ƒë∆∞·ª£c coi l√† m·ªôt trong 10 thu·∫≠t to√°n quan tr·ªçng nh·∫•t th·∫ø k·ª∑ 20, g√≥p ph·∫ßn t·∫°o n√™n n·ªÅn t·∫£ng cho ng√†nh Nghi√™n c·ª©u ho·∫°t ƒë·ªông (Operations Research).</p>
            </div>
        </div>
        
        <div class="main-content">
            <div class="input-section">
                <div class="section">
                    <h3>Thi·∫øt L·∫≠p B√†i To√°n</h3>
                    <div class="instructions">
                        <strong>H∆∞·ªõng d·∫´n:</strong><br>
                        1. Nh·∫≠p h√†m m·ª•c ti√™u<br>
                        2. Th√™m c√°c r√†ng bu·ªôc (‚â§)<br>
                        3. Nh·∫•n "Kh·ªüi t·∫°o Simplex"<br>
                        4. S·ª≠ d·ª•ng "B∆∞·ªõc ti·∫øp theo" ƒë·ªÉ xem t·ª´ng iteration
                    </div>
                    
                    <div class="input-group">
                        <label>H√†m M·ª•c Ti√™u (Maximize):</label>
                        <div class="input-row">
                            <span>z =</span>
                            <input type="number" id="objCoefX1" value="3" step="0.1">
                            <span>x‚ÇÅ +</span>
                            <input type="number" id="objCoefX2" value="2" step="0.1">
                            <span>x‚ÇÇ</span>
                        </div>
                    </div>
                    
                    <div class="input-group">
                        <label>Th√™m R√†ng Bu·ªôc (‚â§):</label>
                        <div class="input-row">
                            <input type="number" id="coefX1" value="1" step="0.1">
                            <span>x‚ÇÅ +</span>
                            <input type="number" id="coefX2" value="1" step="0.1">
                            <span>x‚ÇÇ ‚â§</span>
                            <input type="number" id="rhs" value="6" step="0.1">
                            <button onclick="addConstraint()">Th√™m</button>
                        </div>
                    </div>
                    
                    <div class="constraint-list" id="constraintList">
                        <!-- Constraints will be listed here -->
                    </div>
                    
                    <div style="margin-top: 15px;">
                        <button class="success" onclick="initializeSimplex()">Kh·ªüi t·∫°o Simplex</button>
                        <button class="danger" onclick="clearConstraints()">X√≥a R√†ng Bu·ªôc</button>
                        <button onclick="loadExample()">V√≠ D·ª• M·∫´u</button>
                    </div>
                </div>
                
                <div class="section">
                    <h3>B√†i To√°n Hi·ªán T·∫°i</h3>
                    <div class="problem-display" id="problemDisplay">
                        Ch∆∞a c√≥ b√†i to√°n n√†o ƒë∆∞·ª£c thi·∫øt l·∫≠p
                    </div>
                </div>
            </div>
            
            <div class="tableau-section">
                <div class="iteration-info" id="iterationInfo" style="display: none;">
                    B·∫£ng Simplex ban ƒë·∫ßu
                </div>
                
                <div class="step-info" id="stepInfo" style="display: none;">
                    B∆∞·ªõc: Kh·ªüi t·∫°o b·∫£ng Simplex
                </div>
                
                <div class="controls" id="controls" style="display: none;">
                    <button class="success" onclick="nextStep()" id="nextBtn">B∆∞·ªõc Ti·∫øp Theo</button>
                    <button onclick="autoSolve()" id="autoBtn">Gi·∫£i T·ª± ƒê·ªông</button>
                    <button class="danger" onclick="reset()">Reset</button>
                </div>
                
                <div class="tableau-container">
                    <table class="tableau" id="tableau" style="display: none;">
                        <!-- Tableau will be generated here -->
                    </table>
                </div>
                
                <div class="ratio-test" id="ratioTest" style="display: none;">
                    <h4>Ratio Test (Ki·ªÉm tra t·ª∑ l·ªá)</h4>
                    <div id="ratioContent"></div>
                </div>
                
                <div class="solution-info" id="solutionInfo" style="display: none;">
                    <h3 style="margin-top: 0;">Nghi·ªám T·ªëi ∆Øu T√¨m ƒê∆∞·ª£c!</h3>
                    <div id="solutionContent"></div>
                </div>
                
                <div class="error-info" id="errorInfo" style="display: none;">
                    <div id="errorContent"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let constraints = [];
        let tableau = [];
        let basicVariables = [];
        let iteration = 0;
        let isOptimal = false;
        let isUnbounded = false;
        let currentStep = 'init';
        let pivotRow = -1, pivotCol = -1;
        let objectiveCoefX1 = 3, objectiveCoefX2 = 2;
        
        // Th√™m r√†ng bu·ªôc
        function addConstraint() {
            const x1 = parseFloat(document.getElementById('coefX1').value) || 0;
            const x2 = parseFloat(document.getElementById('coefX2').value) || 0;
            const rhs = parseFloat(document.getElementById('rhs').value) || 0;
            
            if (rhs < 0) {
                alert('RHS ph·∫£i kh√¥ng √¢m!');
                return;
            }
            
            constraints.push({ x1, x2, rhs });
            updateConstraintList();
            updateProblemDisplay();
            
            // Reset form
            document.getElementById('coefX1').value = '';
            document.getElementById('coefX2').value = '';
            document.getElementById('rhs').value = '';
        }
        
        // C·∫≠p nh·∫≠t danh s√°ch r√†ng bu·ªôc
        function updateConstraintList() {
            const list = document.getElementById('constraintList');
            list.innerHTML = '';
            
            constraints.forEach((constraint, index) => {
                const item = document.createElement('div');
                item.className = 'constraint-item';
                item.innerHTML = `
                    <span class="constraint-text">${constraint.x1}x‚ÇÅ + ${constraint.x2}x‚ÇÇ ‚â§ ${constraint.rhs}</span>
                    <button onclick="removeConstraint(${index})" style="padding: 2px 6px; font-size: 12px;">X√≥a</button>
                `;
                list.appendChild(item);
            });
        }
        
        // X√≥a r√†ng bu·ªôc
        function removeConstraint(index) {
            constraints.splice(index, 1);
            updateConstraintList();
            updateProblemDisplay();
        }
        
        // X√≥a t·∫•t c·∫£ r√†ng bu·ªôc
        function clearConstraints() {
            constraints = [];
            updateConstraintList();
            updateProblemDisplay();
            reset();
        }
        
        // C·∫≠p nh·∫≠t hi·ªÉn th·ªã b√†i to√°n
        function updateProblemDisplay() {
            const display = document.getElementById('problemDisplay');
            
            if (constraints.length === 0) {
                display.textContent = 'Ch∆∞a c√≥ b√†i to√°n n√†o ƒë∆∞·ª£c thi·∫øt l·∫≠p';
                return;
            }
            
            objectiveCoefX1 = parseFloat(document.getElementById('objCoefX1').value) || 0;
            objectiveCoefX2 = parseFloat(document.getElementById('objCoefX2').value) || 0;
            
            let text = `Maximize z = ${objectiveCoefX1}x‚ÇÅ + ${objectiveCoefX2}x‚ÇÇ\n\nSubject to:\n`;
            constraints.forEach((constraint, index) => {
                text += `  ${constraint.x1}x‚ÇÅ + ${constraint.x2}x‚ÇÇ ‚â§ ${constraint.rhs}\n`;
            });
            text += `  x‚ÇÅ, x‚ÇÇ ‚â• 0`;
            
            display.textContent = text;
        }
        
        // Kh·ªüi t·∫°o Simplex
        function initializeSimplex() {
            if (constraints.length === 0) {
                alert('Vui l√≤ng th√™m √≠t nh·∫•t m·ªôt r√†ng bu·ªôc!');
                return;
            }
            
            objectiveCoefX1 = parseFloat(document.getElementById('objCoefX1').value) || 0;
            objectiveCoefX2 = parseFloat(document.getElementById('objCoefX2').value) || 0;
            
            // T·∫°o b·∫£ng Simplex ban ƒë·∫ßu
            const numConstraints = constraints.length;
            const numVars = 2; // x1, x2
            const numSlackVars = numConstraints;
            const totalVars = numVars + numSlackVars;
            
            // Kh·ªüi t·∫°o tableau
            tableau = [];
            basicVariables = [];
            
            // H√†ng m·ª•c ti√™u (d√≤ng cu·ªëi)
            const objectiveRow = new Array(totalVars + 1).fill(0);
            objectiveRow[0] = -objectiveCoefX1; // -c1
            objectiveRow[1] = -objectiveCoefX2; // -c2
            // Slack variables c√≥ h·ªá s·ªë 0 trong h√†m m·ª•c ti√™u
            objectiveRow[totalVars] = 0; // RHS c·ªßa h√†m m·ª•c ti√™u
            
            // C√°c h√†ng r√†ng bu·ªôc
            for (let i = 0; i < numConstraints; i++) {
                const row = new Array(totalVars + 1).fill(0);
                row[0] = constraints[i].x1;
                row[1] = constraints[i].x2;
                row[numVars + i] = 1; // Slack variable
                row[totalVars] = constraints[i].rhs;
                tableau.push(row);
                basicVariables.push(`s${i + 1}`); // Slack variables are basic
            }
            
            tableau.push(objectiveRow);
            
            iteration = 0;
            isOptimal = false;
            isUnbounded = false;
            currentStep = 'checkOptimality';
            
            displayTableau();
            document.getElementById('controls').style.display = 'block';
            document.getElementById('iterationInfo').style.display = 'block';
            document.getElementById('iterationInfo').textContent = 'B·∫£ng Simplex ban ƒë·∫ßu';
            document.getElementById('stepInfo').style.display = 'block';
            document.getElementById('stepInfo').textContent = 'B∆∞·ªõc: Ki·ªÉm tra t√≠nh t·ªëi ∆∞u';
        }
        
        // Hi·ªÉn th·ªã b·∫£ng tableau
        function displayTableau() {
            const table = document.getElementById('tableau');
            table.style.display = 'table';
            table.innerHTML = '';
            
            const numConstraints = constraints.length;
            const numVars = 2 + numConstraints; // x1, x2, s1, s2, ...
            
            // Header
            const headerRow = document.createElement('tr');
            headerRow.innerHTML = '<th>Bi·∫øn c∆° s·ªü</th>';
            for (let i = 0; i < 2; i++) {
                headerRow.innerHTML += `<th>x${i + 1}</th>`;
            }
            for (let i = 0; i < numConstraints; i++) {
                headerRow.innerHTML += `<th>s${i + 1}</th>`;
            }
            headerRow.innerHTML += '<th>RHS</th>';
            table.appendChild(headerRow);
            
            // Constraint rows
            for (let i = 0; i < numConstraints; i++) {
                const row = document.createElement('tr');
                const basicVarCell = document.createElement('td');
                basicVarCell.className = 'basic-var';
                basicVarCell.textContent = basicVariables[i];
                row.appendChild(basicVarCell);
                
                for (let j = 0; j <= numVars; j++) {
                    const cell = document.createElement('td');
                    cell.textContent = tableau[i][j].toFixed(3);
                    
                    // Highlight pivot cell, row, column
                    if (i === pivotRow && j === pivotCol && pivotRow !== -1 && pivotCol !== -1) {
                        cell.className = 'pivot-cell';
                    } else if (i === pivotRow && pivotRow !== -1) {
                        cell.className = 'pivot-row';
                    } else if (j === pivotCol && pivotCol !== -1) {
                        cell.className = 'pivot-col';
                    }
                    
                    row.appendChild(cell);
                }
                table.appendChild(row);
            }
            
            // Objective row
            const objRow = document.createElement('tr');
            const objCell = document.createElement('td');
            objCell.className = 'basic-var';
            objCell.textContent = 'z';
            objRow.appendChild(objCell);
            
            const objectiveRowIndex = tableau.length - 1;
            for (let j = 0; j <= numVars; j++) {
                const cell = document.createElement('td');
                cell.textContent = tableau[objectiveRowIndex][j].toFixed(3);
                
                if (j === pivotCol && pivotCol !== -1) {
                    cell.className = 'pivot-col';
                }
                
                objRow.appendChild(cell);
            }
            table.appendChild(objRow);
        }
        
        // B∆∞·ªõc ti·∫øp theo
        function nextStep() {
            switch (currentStep) {
                case 'checkOptimality':
                    checkOptimality();
                    break;
                case 'findEnteringVariable':
                    findEnteringVariable();
                    break;
                case 'findLeavingVariable':
                    findLeavingVariable();
                    break;
                case 'pivot':
                    performPivot();
                    break;
            }
        }
        
        // Ki·ªÉm tra t√≠nh t·ªëi ∆∞u
        function checkOptimality() {
            const objectiveRowIndex = tableau.length - 1;
            const objectiveRow = tableau[objectiveRowIndex];
            
            // T√¨m h·ªá s·ªë √¢m trong h√†ng m·ª•c ti√™u (excluding RHS)
            let hasNegative = false;
            for (let j = 0; j < objectiveRow.length - 1; j++) {
                if (objectiveRow[j] < -1e-10) {
                    hasNegative = true;
                    break;
                }
            }
            
            if (!hasNegative) {
                isOptimal = true;
                showSolution();
                return;
            }
            
            currentStep = 'findEnteringVariable';
            document.getElementById('stepInfo').textContent = 'B∆∞·ªõc: T√¨m bi·∫øn entering (bi·∫øn v√†o c∆° s·ªü)';
            document.getElementById('nextBtn').textContent = 'T√¨m Bi·∫øn V√†o';
        }
        
        // T√¨m bi·∫øn entering
        function findEnteringVariable() {
            const objectiveRowIndex = tableau.length - 1;
            const objectiveRow = tableau[objectiveRowIndex];
            
            // T√¨m h·ªá s·ªë √¢m nh·ªè nh·∫•t (most negative)
            let minValue = 0;
            pivotCol = -1;
            
            for (let j = 0; j < objectiveRow.length - 1; j++) {
                if (objectiveRow[j] < minValue) {
                    minValue = objectiveRow[j];
                    pivotCol = j;
                }
            }
            
            if (pivotCol === -1) {
                isOptimal = true;
                showSolution();
                return;
            }
            
            currentStep = 'findLeavingVariable';
            document.getElementById('stepInfo').textContent = `B∆∞·ªõc: Bi·∫øn v√†o x${pivotCol < 2 ? pivotCol + 1 : 's' + (pivotCol - 1)}. T√¨m bi·∫øn leaving (bi·∫øn ra kh·ªèi c∆° s·ªü)`;
            document.getElementById('nextBtn').textContent = 'T√¨m Bi·∫øn Ra';
            displayTableau();
        }
        
        // T√¨m bi·∫øn leaving
        function findLeavingVariable() {
            let minRatio = Infinity;
            pivotRow = -1;
            let ratioInfo = [];
            
            // Ratio test
            for (let i = 0; i < constraints.length; i++) {
                const pivot = tableau[i][pivotCol];
                const rhs = tableau[i][tableau[i].length - 1];
                
                if (pivot > 1e-10) { // Ch·ªâ x√©t pivot > 0
                    const ratio = rhs / pivot;
                    ratioInfo.push({
                        row: i,
                        variable: basicVariables[i],
                        rhs: rhs,
                        pivot: pivot,
                        ratio: ratio
                    });
                    
                    if (ratio < minRatio) {
                        minRatio = ratio;
                        pivotRow = i;
                    }
                }
            }
            
            if (pivotRow === -1) {
                isUnbounded = true;
                showError('B√†i to√°n kh√¥ng b·ªã ch·∫∑n (unbounded)!');
                return;
            }
            
            // Hi·ªÉn th·ªã ratio test
            displayRatioTest(ratioInfo);
            
            currentStep = 'pivot';
            document.getElementById('stepInfo').textContent = `B∆∞·ªõc: Bi·∫øn ra ${basicVariables[pivotRow]}. Th·ª±c hi·ªán pivot operation`;
            document.getElementById('nextBtn').textContent = 'Th·ª±c Hi·ªán Pivot';
            displayTableau();
        }
        
        // Hi·ªÉn th·ªã ratio test
        function displayRatioTest(ratioInfo) {
            const ratioTest = document.getElementById('ratioTest');
            const ratioContent = document.getElementById('ratioContent');
            
            let content = '';
            ratioInfo.forEach(info => {
                const isSelected = info.row === pivotRow;
                content += `<div style="margin: 5px 0; ${isSelected ? 'font-weight: bold; color: #e74c3c;' : ''}">
                    ${info.variable}: ${info.rhs.toFixed(3)} / ${info.pivot.toFixed(3)} = ${info.ratio.toFixed(3)} ${isSelected ? '‚Üê Minimum' : ''}
                </div>`;
            });
            
            ratioContent.innerHTML = content;
            ratioTest.style.display = 'block';
        }
        
        // Th·ª±c hi·ªán pivot operation
        function performPivot() {
            iteration++;
            
            const pivotElement = tableau[pivotRow][pivotCol];
            
            // Normalize pivot row
            for (let j = 0; j < tableau[pivotRow].length; j++) {
                tableau[pivotRow][j] /= pivotElement;
            }
            
            // Eliminate other rows
            for (let i = 0; i < tableau.length; i++) {
                if (i !== pivotRow) {
                    const factor = tableau[i][pivotCol];
                    for (let j = 0; j < tableau[i].length; j++) {
                        tableau[i][j] -= factor * tableau[pivotRow][j];
                    }
                }
            }
            
            // Update basic variable
            const varNames = ['x‚ÇÅ', 'x‚ÇÇ'];
            for (let i = 2; i < 2 + constraints.length; i++) {
                varNames.push(`s${i - 1}`);
            }
            basicVariables[pivotRow] = varNames[pivotCol];
            
            pivotRow = -1;
            pivotCol = -1;
            currentStep = 'checkOptimality';
            
            document.getElementById('iterationInfo').textContent = `Iteration ${iteration}`;
            document.getElementById('stepInfo').textContent = 'B∆∞·ªõc: Ki·ªÉm tra t√≠nh t·ªëi ∆∞u';
            document.getElementById('nextBtn').textContent = 'Ki·ªÉm Tra T·ªëi ∆Øu';
            document.getElementById('ratioTest').style.display = 'none';
            
            displayTableau();
        }
        
        // Hi·ªÉn th·ªã nghi·ªám
        function showSolution() {
            const objectiveRowIndex = tableau.length - 1;
            const objectiveValue = tableau[objectiveRowIndex][tableau[objectiveRowIndex].length - 1];
            
            let solutionText = `<div><strong>S·ªë iterations: ${iteration}</strong></div>`;
            solutionText += `<div><strong>Gi√° tr·ªã t·ªëi ∆∞u: z* = ${objectiveValue.toFixed(4)}</strong></div><br>`;
            
            // T√¨m gi√° tr·ªã c√°c bi·∫øn
            const variableValues = { x1: 0, x2: 0 };
            
            for (let i = 0; i < basicVariables.length; i++) {
                const varName = basicVariables[i];
                const value = tableau[i][tableau[i].length - 1];
                
                if (varName === 'x‚ÇÅ') variableValues.x1 = value;
                else if (varName === 'x‚ÇÇ') variableValues.x2 = value;
                
                solutionText += `<div>${varName} = ${value.toFixed(4)}</div>`;
            }
            
            solutionText += `<br><div><strong>Nghi·ªám t·ªëi ∆∞u: (${variableValues.x1.toFixed(4)}, ${variableValues.x2.toFixed(4)})</strong></div>`;
            
            document.getElementById('solutionContent').innerHTML = solutionText;
            document.getElementById('solutionInfo').style.display = 'block';
            document.getElementById('nextBtn').disabled = true;
            document.getElementById('autoBtn').disabled = true;
        }
        
        // Hi·ªÉn th·ªã l·ªói
        function showError(message) {
            document.getElementById('errorContent').textContent = message;
            document.getElementById('errorInfo').style.display = 'block';
            document.getElementById('nextBtn').disabled = true;
            document.getElementById('autoBtn').disabled = true;
        }
        
        // Gi·∫£i t·ª± ƒë·ªông
        function autoSolve() {
            const maxIterations = 20;
            let count = 0;
            
            const solve = () => {
                if (count >= maxIterations) {
                    showError('Qu√° nhi·ªÅu iterations! C√≥ th·ªÉ b√†i to√°n c√≥ v·∫•n ƒë·ªÅ.');
                    return;
                }
                
                if (!isOptimal && !isUnbounded) {
                    nextStep();
                    count++;
                    setTimeout(solve, 500); // Delay 500ms gi·ªØa c√°c b∆∞·ªõc
                }
            };
            
            solve();
        }
        
        // Reset
        function reset() {
            tableau = [];
            basicVariables = [];
            iteration = 0;
            isOptimal = false;
            isUnbounded = false;
            currentStep = 'init';
            pivotRow = -1;
            pivotCol = -1;
            
            document.getElementById('controls').style.display = 'none';
            document.getElementById('tableau').style.display = 'none';
            document.getElementById('iterationInfo').style.display = 'none';
            document.getElementById('stepInfo').style.display = 'none';
            document.getElementById('solutionInfo').style.display = 'none';
            document.getElementById('errorInfo').style.display = 'none';
            document.getElementById('ratioTest').style.display = 'none';
            
            document.getElementById('nextBtn').disabled = false;
            document.getElementById('autoBtn').disabled = false;
            document.getElementById('nextBtn').textContent = 'B∆∞·ªõc Ti·∫øp Theo';
        }
        
        // T·∫£i v√≠ d·ª• m·∫´u
        function loadExample() {
            clearConstraints();
            
            // V√≠ d·ª•: Maximize 3x1 + 2x2
            // Subject to: x1 + x2 <= 6, 2x1 + x2 <= 8
            constraints = [
                { x1: 1, x2: 1, rhs: 6 },
                { x1: 2, x2: 1, rhs: 8 }
            ];
            
            document.getElementById('objCoefX1').value = 3;
            document.getElementById('objCoefX2').value = 2;
            
            updateConstraintList();
            updateProblemDisplay();
        }
        
        // Event listeners
        document.getElementById('objCoefX1').addEventListener('change', updateProblemDisplay);
        document.getElementById('objCoefX2').addEventListener('change', updateProblemDisplay);
        
        // Kh·ªüi t·∫°o
        updateProblemDisplay();
        loadExample();
    </script>
</body>
</html> 
