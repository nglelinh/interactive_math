<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minh h·ªça Thu·∫≠t to√°n Simplex</title>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
  <script src="../math-simple.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 30px;
            backdrop-filter: blur(10px);
        }
        h1 {
            text-align: center;
            margin-bottom: 30px;
            color: #fff;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .control-group {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .control-group h3 {
            margin-top: 0;
            margin-bottom: 15px;
            color: #fff;
        }
        .control-row {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        .control-row label {
            min-width: 120px;
            margin-right: 10px;
        }
        input[type="number"] {
            width: 80px;
            padding: 5px;
            border: none;
            border-radius: 5px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            margin-right: 10px;
        }
        button {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-weight: bold;
        }
        button:hover {
            transform: scale(1.05);
        }
        .simplex-table {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            overflow-x: auto;
        }
        .simplex-table table {
            width: 100%;
            border-collapse: collapse;
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            border-radius: 8px;
            overflow: hidden;
        }
        .simplex-table th,
        .simplex-table td {
            padding: 12px;
            text-align: center;
            border: 1px solid #ddd;
        }
        .simplex-table th {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            font-weight: bold;
        }
        .simplex-table tr:nth-child(even) {
            background: rgba(255, 255, 255, 0.1);
        }
        .pivot-element {
            background: #ff6b6b !important;
            color: white !important;
            font-weight: bold;
        }
        .entering-variable {
            background: #4ecdc4 !important;
            color: white !important;
        }
        .leaving-variable {
            background: #ffd700 !important;
            color: #333 !important;
        }
        .info-panel {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
        }
        .info-panel h3 {
            margin-top: 0;
            color: #fff;
        }
        .step-info {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
        }
        .formula {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
        }
        .buttons {
            text-align: center;
            margin: 20px 0;
        }
        .iteration-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        .iteration-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
        .iteration-card.current {
            background: linear-gradient(45deg, #4CAF50, #45a049);
        }
    </style>





</head>
<body>
    <div class="container">
        <h1>üßÆ Minh h·ªça Thu·∫≠t to√°n Simplex</h1>
        
        <div class="controls">
            <div class="control-group">
                <h3>üìä H√†m m·ª•c ti√™u</h3>
                <div class="control-row">
                    <label>Coefficient x‚ÇÅ:</label>
                    <input type="number" id="c1" value="40" min="-100" max="100">
                </div>
                <div class="control-row">
                    <label>Coefficient x‚ÇÇ:</label>
                    <input type="number" id="c2" value="30" min="-100" max="100">
                </div>
                <div class="formula">
                    <strong>Maximize Z = <span id="objectiveFormula">40x‚ÇÅ + 30x‚ÇÇ</span></strong>
                </div>
            </div>
            
            <div class="control-group">
                <h3>üîß R√†ng bu·ªôc 1</h3>
                <div class="control-row">
                    <label>Coefficient x‚ÇÅ:</label>
                    <input type="number" id="a11" value="2" min="-10" max="10" step="0.5">
                </div>
                <div class="control-row">
                    <label>Coefficient x‚ÇÇ:</label>
                    <input type="number" id="a12" value="1" min="-10" max="10" step="0.5">
                </div>
                <div class="control-row">
                    <label>RHS:</label>
                    <input type="number" id="b1" value="100" min="1" max="500">
                </div>
                <div class="formula">
                    <strong><span id="constraint1Formula">2x‚ÇÅ + x‚ÇÇ ‚â§ 100</span></strong>
                </div>
            </div>
            
            <div class="control-group">
                <h3>üå≥ R√†ng bu·ªôc 2</h3>
                <div class="control-row">
                    <label>Coefficient x‚ÇÅ:</label>
                    <input type="number" id="a21" value="3" min="-10" max="10" step="0.5">
                </div>
                <div class="control-row">
                    <label>Coefficient x‚ÇÇ:</label>
                    <input type="number" id="a22" value="2" min="-10" max="10" step="0.5">
                </div>
                <div class="control-row">
                    <label>RHS:</label>
                    <input type="number" id="b2" value="120" min="1" max="500">
                </div>
                <div class="formula">
                    <strong><span id="constraint2Formula">3x‚ÇÅ + 2x‚ÇÇ ‚â§ 120</span></strong>
                </div>
            </div>
        </div>
        
        <div class="buttons">
            <button onclick="setupProblem()">üîÑ Thi·∫øt l·∫≠p b√†i to√°n</button>
            <button onclick="nextStep()">‚è≠Ô∏è B∆∞·ªõc ti·∫øp theo</button>
            <button onclick="resetSimplex()">üîÑ L√†m l·∫°i</button>
            <button onclick="solveComplete()">üèÅ Gi·∫£i ho√†n ch·ªânh</button>
        </div>
        
        <div class="simplex-table">
            <h3>üìã B·∫£ng Simplex</h3>
            <div id="tableauContainer">
                <!-- Simplex tableau will be generated here -->
            </div>
        </div>
        
        <div class="info-panel">
            <h3>üìà Th√¥ng tin b∆∞·ªõc hi·ªán t·∫°i</h3>
            <div id="stepInfo" class="step-info">
                <p><strong>B∆∞·ªõc:</strong> Thi·∫øt l·∫≠p b√†i to√°n</p>
                <p><strong>Tr·∫°ng th√°i:</strong> Ch∆∞a b·∫Øt ƒë·∫ßu</p>
            </div>
            
            <div class="iteration-info" id="iterationInfo">
                <!-- Iteration information will be displayed here -->
            </div>
            
            <h4>üéØ H∆∞·ªõng d·∫´n thu·∫≠t to√°n:</h4>
            <div id="algorithmGuide">
                <p><strong>1. Thi·∫øt l·∫≠p:</strong> Chuy·ªÉn b√†i to√°n v·ªÅ d·∫°ng chu·∫©n</p>
                <p><strong>2. B·∫£ng ban ƒë·∫ßu:</strong> T·∫°o b·∫£ng Simplex v·ªõi bi·∫øn slack</p>
                <p><strong>3. Ki·ªÉm tra t·ªëi ∆∞u:</strong> Xem t·∫•t c·∫£ Cj-Zj ‚â§ 0?</p>
                <p><strong>4. Ch·ªçn bi·∫øn v√†o:</strong> C·ªôt c√≥ Cj-Zj d∆∞∆°ng l·ªõn nh·∫•t</p>
                <p><strong>5. Ch·ªçn bi·∫øn ra:</strong> Minimum ratio test</p>
                <p><strong>6. Pivot:</strong> Th·ª±c hi·ªán ph√©p bi·∫øn ƒë·ªïi h√†ng</p>
                <p><strong>7. L·∫∑p l·∫°i:</strong> Quay l·∫°i b∆∞·ªõc 3</p>
            </div>
        </div>
    </div>

    <script>
        // Simplex algorithm state
        let simplexState = {
            iteration: 0,
            tableau: [],
            basicVariables: [],
            nonBasicVariables: [],
            enteringVariable: null,
            leavingVariable: null,
            pivotElement: null,
            isOptimal: false,
            isUnbounded: false
        };
        
        // Problem parameters
        let problem = {
            c1: 40, c2: 30,
            a11: 2, a12: 1, b1: 100,
            a21: 3, a22: 2, b2: 120
        };
        
        // Update problem parameters
        function updateProblem() {
            problem.c1 = parseFloat(document.getElementById('c1').value);
            problem.c2 = parseFloat(document.getElementById('c2').value);
            problem.a11 = parseFloat(document.getElementById('a11').value);
            problem.a12 = parseFloat(document.getElementById('a12').value);
            problem.b1 = parseFloat(document.getElementById('b1').value);
            problem.a21 = parseFloat(document.getElementById('a21').value);
            problem.a22 = parseFloat(document.getElementById('a22').value);
            problem.b2 = parseFloat(document.getElementById('b2').value);
            
            updateFormulas();
        }
        
        // Update formulas display
        function updateFormulas() {
            document.getElementById('objectiveFormula').textContent = 
                `${problem.c1}x‚ÇÅ + ${problem.c2}x‚ÇÇ`;
            document.getElementById('constraint1Formula').textContent = 
                `${problem.a11}x‚ÇÅ + ${problem.a12}x‚ÇÇ ‚â§ ${problem.b1}`;
            document.getElementById('constraint2Formula').textContent = 
                `${problem.a21}x‚ÇÅ + ${problem.a22}x‚ÇÇ ‚â§ ${problem.b2}`;
        }
        
        // Setup the initial simplex tableau
        function setupProblem() {
            updateProblem();
            
            // Standard form: Add slack variables
            // 2x‚ÇÅ + x‚ÇÇ + s‚ÇÅ = 100
            // 3x‚ÇÅ + 2x‚ÇÇ + s‚ÇÇ = 120
            // Maximize Z = 40x‚ÇÅ + 30x‚ÇÇ
            
            simplexState.tableau = [
                [1, 0, problem.a11, problem.a12, 0, problem.b1],  // s‚ÇÅ row
                [0, 1, problem.a21, problem.a22, 0, problem.b2],  // s‚ÇÇ row
                [0, 0, -problem.c1, -problem.c2, 1, 0]            // Z row
            ];
            
            simplexState.basicVariables = ['s‚ÇÅ', 's‚ÇÇ'];
            simplexState.nonBasicVariables = ['x‚ÇÅ', 'x‚ÇÇ'];
            simplexState.iteration = 0;
            simplexState.isOptimal = false;
            simplexState.isUnbounded = false;
            
            updateTableau();
            updateStepInfo();
        }
        
        // Update the simplex tableau display
        function updateTableau() {
            const container = document.getElementById('tableauContainer');
            
            // Check if tableau exists and is not empty
            if (!simplexState.tableau || simplexState.tableau.length === 0) {
                container.innerHTML = '<p>Tableau not initialized. Click "Setup Problem" to begin.</p>';
                return;
            }
            
            let html = '<table><thead><tr>';
            html += '<th>Basis</th><th>C_B</th>';
            html += '<th>x‚ÇÅ</th><th>x‚ÇÇ</th>';
            html += '<th>s‚ÇÅ</th><th>s‚ÇÇ</th>';
            html += '<th>RHS</th><th>Ratio</th>';
            html += '</tr></thead><tbody>';
            
            // Basic variable rows
            for (let i = 0; i < simplexState.basicVariables.length; i++) {
                const basicVar = simplexState.basicVariables[i];
                const row = simplexState.tableau[i];
                
                // Safety check for row existence
                if (!row) continue;
                
                html += '<tr>';
                html += `<td>${basicVar}</td>`;
                html += '<td>0</td>'; // C_B for slack variables
                
                for (let j = 0; j < row.length - 1; j++) {
                    let cellClass = '';
                    if (simplexState.enteringVariable === j && simplexState.leavingVariable === i) {
                        cellClass = 'pivot-element';
                    } else if (simplexState.enteringVariable === j) {
                        cellClass = 'entering-variable';
                    } else if (simplexState.leavingVariable === i) {
                        cellClass = 'leaving-variable';
                    }
                    
                    html += `<td class="${cellClass}">${row[j].toFixed(2)}</td>`;
                }
                
                // RHS
                html += `<td>${row[row.length - 1].toFixed(2)}</td>`;
                
                // Ratio (for entering variable column)
                if (simplexState.enteringVariable !== null) {
                    const pivotCol = simplexState.enteringVariable;
                    const pivotVal = row[pivotCol];
                    if (pivotVal > 0) {
                        const ratio = row[row.length - 1] / pivotVal;
                        html += `<td>${ratio.toFixed(2)}</td>`;
                    } else {
                        html += '<td>-</td>';
                    }
                } else {
                    html += '<td>-</td>';
                }
                
                html += '</tr>';
            }
            
            // Z row
            const zRow = simplexState.tableau[simplexState.tableau.length - 1];
            if (zRow) {
                html += '<tr style="background: rgba(255, 255, 255, 0.2);">';
                html += '<td>Z</td>';
                html += '<td>-</td>';
                
                for (let j = 0; j < zRow.length - 1; j++) {
                    html += `<td>${zRow[j].toFixed(2)}</td>`;
                }
                html += `<td>${zRow[zRow.length - 1].toFixed(2)}</td>`;
                html += '<td>-</td>';
                html += '</tr>';
            }
            
            html += '</tbody></table>';
            container.innerHTML = html;
        }
        
        // Check if current solution is optimal
        function checkOptimality() {
            // Safety check for tableau existence
            if (!simplexState.tableau || simplexState.tableau.length === 0) {
                return false;
            }
            
            const zRow = simplexState.tableau[simplexState.tableau.length - 1];
            if (!zRow) return false;
            
            for (let j = 0; j < zRow.length - 1; j++) {
                if (zRow[j] > 0.001) { // Allow small numerical errors
                    return false;
                }
            }
            return true;
        }
        
        // Find entering variable (most positive Cj-Zj)
        function findEnteringVariable() {
            // Safety check for tableau existence
            if (!simplexState.tableau || simplexState.tableau.length === 0) {
                return -1;
            }
            
            const zRow = simplexState.tableau[simplexState.tableau.length - 1];
            if (!zRow) return -1;
            
            let maxValue = 0;
            let enteringCol = -1;
            
            for (let j = 0; j < zRow.length - 1; j++) {
                if (zRow[j] > maxValue) {
                    maxValue = zRow[j];
                    enteringCol = j;
                }
            }
            
            return enteringCol;
        }
        
        // Find leaving variable (minimum ratio test)
        function findLeavingVariable(enteringCol) {
            // Safety check for tableau existence
            if (!simplexState.tableau || simplexState.tableau.length === 0) {
                return -1;
            }
            
            let minRatio = Infinity;
            let leavingRow = -1;
            
            for (let i = 0; i < simplexState.tableau.length - 1; i++) {
                const row = simplexState.tableau[i];
                if (!row) continue;
                
                const pivotVal = row[enteringCol];
                if (pivotVal > 0) {
                    const ratio = row[row.length - 1] / pivotVal;
                    if (ratio < minRatio) {
                        minRatio = ratio;
                        leavingRow = i;
                    }
                }
            }
            
            return leavingRow;
        }
        
        // Perform pivot operation
        function performPivot(enteringCol, leavingRow) {
            const pivotElement = simplexState.tableau[leavingRow][enteringCol];
            
            // Update basic variables
            simplexState.basicVariables[leavingRow] = simplexState.nonBasicVariables[enteringCol];
            
            // Normalize pivot row
            for (let j = 0; j < simplexState.tableau[leavingRow].length; j++) {
                simplexState.tableau[leavingRow][j] /= pivotElement;
            }
            
            // Eliminate pivot column in other rows
            for (let i = 0; i < simplexState.tableau.length; i++) {
                if (i !== leavingRow) {
                    const factor = simplexState.tableau[i][enteringCol];
                    for (let j = 0; j < simplexState.tableau[i].length; j++) {
                        simplexState.tableau[i][j] -= factor * simplexState.tableau[leavingRow][j];
                    }
                }
            }
        }
        
        // Next step in simplex algorithm
        function nextStep() {
            if (simplexState.iteration === 0) {
                setupProblem();
                simplexState.iteration = 1;
                updateStepInfo();
                return;
            }
            
            // Check optimality
            if (checkOptimality()) {
                simplexState.isOptimal = true;
                updateStepInfo();
                return;
            }
            
            // Find entering variable
            const enteringCol = findEnteringVariable();
            if (enteringCol === -1) {
                simplexState.isOptimal = true;
                updateStepInfo();
                return;
            }
            
            simplexState.enteringVariable = enteringCol;
            
            // Find leaving variable
            const leavingRow = findLeavingVariable(enteringCol);
            if (leavingRow === -1) {
                simplexState.isUnbounded = true;
                updateStepInfo();
                return;
            }
            
            simplexState.leavingVariable = leavingRow;
            simplexState.pivotElement = simplexState.tableau[leavingRow][enteringCol];
            
            // Perform pivot
            performPivot(enteringCol, leavingRow);
            
            simplexState.iteration++;
            simplexState.enteringVariable = null;
            simplexState.leavingVariable = null;
            simplexState.pivotElement = null;
            
            updateTableau();
            updateStepInfo();
        }
        
        // Solve the complete problem
        function solveComplete() {
            setupProblem();
            
            while (!simplexState.isOptimal && !simplexState.isUnbounded && simplexState.iteration < 10) {
                nextStep();
            }
        }
        
        // Reset simplex algorithm
        function resetSimplex() {
            simplexState = {
                iteration: 0,
                tableau: [],
                basicVariables: [],
                nonBasicVariables: [],
                enteringVariable: null,
                leavingVariable: null,
                pivotElement: null,
                isOptimal: false,
                isUnbounded: false
            };
            
            // Setup the problem with initial tableau
            setupProblem();
        }
        
        // Update step information
        function updateStepInfo() {
            const stepInfo = document.getElementById('stepInfo');
            const iterationInfo = document.getElementById('iterationInfo');
            
            let stepText = '';
            let statusText = '';
            
            if (simplexState.iteration === 0) {
                stepText = 'Thi·∫øt l·∫≠p b√†i to√°n';
                statusText = 'Ch∆∞a b·∫Øt ƒë·∫ßu';
            } else if (simplexState.isOptimal) {
                stepText = 'ƒê√£ t·ªëi ∆∞u';
                statusText = 'Ho√†n th√†nh';
            } else if (simplexState.isUnbounded) {
                stepText = 'Kh√¥ng gi·ªõi h·∫°n';
                statusText = 'B√†i to√°n kh√¥ng c√≥ nghi·ªám h·ªØu h·∫°n';
            } else {
                stepText = `B∆∞·ªõc ${simplexState.iteration}`;
                if (simplexState.enteringVariable !== null) {
                    statusText = `Ch·ªçn bi·∫øn v√†o: x${simplexState.enteringVariable + 1}`;
                } else if (simplexState.leavingVariable !== null) {
                    statusText = `Ch·ªçn bi·∫øn ra: ${simplexState.basicVariables[simplexState.leavingVariable]}`;
                } else {
                    statusText = 'ƒêang x·ª≠ l√Ω...';
                }
            }
            
            stepInfo.innerHTML = `
                <p><strong>B∆∞·ªõc:</strong> ${stepText}</p>
                <p><strong>Tr·∫°ng th√°i:</strong> ${statusText}</p>
            `;
            
            // Update iteration info
            let iterationHtml = '';
            for (let i = 0; i <= simplexState.iteration; i++) {
                const isCurrent = i === simplexState.iteration;
                iterationHtml += `
                    <div class="iteration-card ${isCurrent ? 'current' : ''}">
                        <strong>L·∫ßn l·∫∑p ${i}</strong><br>
                        ${i === 0 ? 'Kh·ªüi t·∫°o' : 'Pivot'}
                    </div>
                `;
            }
            iterationInfo.innerHTML = iterationHtml;
        }
        
        // Event listeners for input changes
        document.getElementById('c1').addEventListener('input', updateProblem);
        document.getElementById('c2').addEventListener('input', updateProblem);
        document.getElementById('a11').addEventListener('input', updateProblem);
        document.getElementById('a12').addEventListener('input', updateProblem);
        document.getElementById('b1').addEventListener('input', updateProblem);
        document.getElementById('a21').addEventListener('input', updateProblem);
        document.getElementById('a22').addEventListener('input', updateProblem);
        document.getElementById('b2').addEventListener('input', updateProblem);
        
        // Initialize
        updateProblem();
        resetSimplex();
    </script>
</body>
</html> 
