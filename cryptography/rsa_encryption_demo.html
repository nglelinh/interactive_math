<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîê RSA Encryption - Interactive Cryptography Demo</title>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #0f0f0f 0%, #1a1a2e 50%, #16213e 100%);
            color: #ffffff;
            min-height: 100vh;
            font-size: 16px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 30px;
            backdrop-filter: blur(10px);
        }
        
        h1 {
            text-align: center;
            color: #00d4ff;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
        
        .subtitle {
            text-align: center;
            color: #ffd700;
            font-size: 1.2em;
            margin-bottom: 30px;
            opacity: 0.9;
        }
        
        .toggle-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .toggle-btn {
            padding: 12px 25px;
            font-size: 16px;
            font-weight: bold;
            border: 2px solid #00d4ff;
            background: rgba(255, 255, 255, 0.1);
            color: #00d4ff;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        
        .toggle-btn.active {
            background: #00d4ff;
            color: #1a1a2e;
        }
        
        .section {
            margin: 20px 0;
        }
        
        .theory {
            background: rgba(255, 255, 255, 0.03);
            padding: 25px;
            border-radius: 12px;
            border-left: 4px solid #00d4ff;
        }
        
        .demo-panel {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        .control-panel {
            background: rgba(255, 255, 255, 0.08);
            padding: 20px;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .control-group {
            margin: 15px 0;
        }
        
        .control-group label {
            display: block;
            font-weight: bold;
            margin-bottom: 8px;
            color: #00d4ff;
        }
        
        .control-group input, .control-group textarea, .control-group select {
            width: 100%;
            padding: 10px;
            font-size: 14px;
            border: 1px solid #444;
            border-radius: 5px;
            background: rgba(255, 255, 255, 0.1);
            color: #ffffff;
            box-sizing: border-box;
        }
        
        .control-group textarea {
            min-height: 80px;
            resize: vertical;
            font-family: 'Courier New', monospace;
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 20px;
            font-size: 14px;
            font-weight: bold;
            border-radius: 6px;
            cursor: pointer;
            transition: transform 0.2s ease;
            margin: 5px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #00d4ff 0%, #0099cc 100%);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #00ff88 0%, #00cc66 100%);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #ffd700 0%, #ffaa00 100%);
            color: #333;
        }
        
        .result-panel {
            background: rgba(0, 212, 255, 0.1);
            border: 1px solid #00d4ff;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .result-panel h4 {
            margin: 0 0 10px 0;
            color: #00d4ff;
        }
        
        .math-display {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            border-left: 3px solid #ffd700;
        }
        
        .step-by-step {
            background: rgba(255, 215, 0, 0.1);
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 3px solid #ffd700;
        }
        
        .step {
            margin: 10px 0;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 5px;
        }
        
        .highlight {
            background: rgba(255, 215, 0, 0.2);
            padding: 2px 4px;
            border-radius: 3px;
            font-weight: bold;
        }
        
        .security-analysis {
            background: rgba(255, 0, 0, 0.1);
            border: 1px solid #ff4444;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .security-analysis h4 {
            color: #ff4444;
            margin: 0 0 10px 0;
        }
        
        @media (max-width: 768px) {
            .demo-panel {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîê RSA Encryption Demo</h1>
        <div class="subtitle">
            Interactive exploration of RSA public-key cryptography with real-time mathematical computations
        </div>
        
        <div class="toggle-buttons">
            <button class="toggle-btn active" id="theoryBtn" onclick="showSection('theory')">üìö Theory</button>
            <button class="toggle-btn" id="demoBtn" onclick="showSection('demo')">üîß Interactive Demo</button>
            <button class="toggle-btn" id="securityBtn" onclick="showSection('security')">üõ°Ô∏è Security Analysis</button>
        </div>

        <div id="theorySection" class="section theory">
            <h2>üéì RSA Algorithm Theory</h2>
            
            <div class="step-by-step">
                <h3>üî¢ Mathematical Foundation</h3>
                <p><strong>RSA</strong> (Rivest-Shamir-Adleman) is based on the computational difficulty of factoring large integers.</p>
                
                <div class="step">
                    <h4>Step 1: Prime Generation</h4>
                    <p>Choose two large prime numbers <span class="highlight">p</span> and <span class="highlight">q</span></p>
                    <p>Compute <span class="highlight">n = p √ó q</span> (modulus)</p>
                    <p>Compute <span class="highlight">œÜ(n) = (p-1)(q-1)</span> (Euler's totient)</p>
                </div>
                
                <div class="step">
                    <h4>Step 2: Key Generation</h4>
                    <p>Choose <span class="highlight">e</span> such that 1 < e < œÜ(n) and gcd(e, œÜ(n)) = 1</p>
                    <p>Compute <span class="highlight">d</span> such that e √ó d ‚â° 1 (mod œÜ(n))</p>
                    <p><strong>Public Key:</strong> (n, e)</p>
                    <p><strong>Private Key:</strong> (n, d)</p>
                </div>
                
                <div class="step">
                    <h4>Step 3: Encryption/Decryption</h4>
                    <p><strong>Encryption:</strong> c = m^e mod n</p>
                    <p><strong>Decryption:</strong> m = c^d mod n</p>
                    <p>Where m is the message and c is the ciphertext</p>
                </div>
            </div>
            
            <div class="math-display">
                <h4>üßÆ Key Mathematical Properties:</h4>
                <p><strong>Euler's Theorem:</strong> If gcd(a,n) = 1, then a^œÜ(n) ‚â° 1 (mod n)</p>
                <p><strong>RSA Correctness:</strong> m^(ed) ‚â° m (mod n)</p>
                <p><strong>Security Basis:</strong> Factoring n = p√óq is computationally hard for large primes</p>
            </div>
        </div>

        <div id="demoSection" class="section" style="display:none;">
            <h2>üîß Interactive RSA Demo</h2>
            
            <div class="demo-panel">
                <div class="control-panel">
                    <h3>üîë Key Generation</h3>
                    
                    <div class="control-group">
                        <label>Prime p:</label>
                        <input type="number" id="primeP" value="61" min="3" max="1000">
                        <button class="btn btn-warning" onclick="generateRandomPrime('primeP')">Random Prime</button>
                    </div>
                    
                    <div class="control-group">
                        <label>Prime q:</label>
                        <input type="number" id="primeQ" value="53" min="3" max="1000">
                        <button class="btn btn-warning" onclick="generateRandomPrime('primeQ')">Random Prime</button>
                    </div>
                    
                    <div class="control-group">
                        <label>Public Exponent e:</label>
                        <select id="publicE" onchange="updateKeys()">
                            <option value="3">3</option>
                            <option value="17">17</option>
                            <option value="65537" selected>65537</option>
                        </select>
                    </div>
                    
                    <button class="btn btn-primary" onclick="generateKeys()">üîë Generate RSA Keys</button>
                    
                    <div class="result-panel">
                        <h4>üìä Generated Keys:</h4>
                        <div id="keyResults">
                            <p>Click "Generate RSA Keys" to see results</p>
                        </div>
                    </div>
                </div>
                
                <div class="control-panel">
                    <h3>üîê Encryption/Decryption</h3>
                    
                    <div class="control-group">
                        <label>Message (number):</label>
                        <input type="number" id="messageInput" value="42" min="1">
                        <button class="btn btn-warning" onclick="convertTextToNumber()">Text ‚Üí Number</button>
                    </div>
                    
                    <div class="control-group">
                        <label>Text Message (optional):</label>
                        <input type="text" id="textMessage" value="HELLO" placeholder="Enter text message">
                    </div>
                    
                    <button class="btn btn-success" onclick="encryptMessage()">üîí Encrypt</button>
                    <button class="btn btn-primary" onclick="decryptMessage()">üîì Decrypt</button>
                    
                    <div class="result-panel">
                        <h4>üîÑ Encryption/Decryption Results:</h4>
                        <div id="cryptoResults">
                            <p>Generate keys first, then encrypt a message</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="step-by-step">
                <h3>üìù Step-by-Step Calculation</h3>
                <div id="calculationSteps">
                    <p>Perform encryption or decryption to see detailed steps</p>
                </div>
            </div>
        </div>

        <div id="securitySection" class="section" style="display:none;">
            <h2>üõ°Ô∏è RSA Security Analysis</h2>
            
            <div class="security-analysis">
                <h4>‚ö†Ô∏è Small Prime Warning</h4>
                <p>This demo uses small primes for educational purposes. In practice, RSA requires primes with at least 1024 bits (300+ digits) for security!</p>
            </div>
            
            <div class="control-panel">
                <h3>üîç Factorization Attack Simulation</h3>
                <div class="control-group">
                    <label>Target n to factor:</label>
                    <input type="number" id="targetN" value="3233" readonly>
                </div>
                <button class="btn btn-warning" onclick="simulateFactorization()">üéØ Attempt Factorization</button>
                
                <div class="result-panel">
                    <h4>üí• Factorization Results:</h4>
                    <div id="factorizationResults">
                        <p>Try to break the RSA modulus n</p>
                    </div>
                </div>
            </div>
            
            <div class="step-by-step">
                <h3>üîí Security Considerations</h3>
                
                <div class="step">
                    <h4>Key Size Requirements</h4>
                    <p><strong>Minimum:</strong> 2048 bits (617 digits)</p>
                    <p><strong>Recommended:</strong> 3072 bits (925 digits)</p>
                    <p><strong>Future-proof:</strong> 4096 bits (1234 digits)</p>
                </div>
                
                <div class="step">
                    <h4>Common Attacks</h4>
                    <p><strong>Factorization:</strong> Break n = p√óq</p>
                    <p><strong>Small e attacks:</strong> If e is too small</p>
                    <p><strong>Timing attacks:</strong> Analyze computation time</p>
                    <p><strong>Side-channel:</strong> Power analysis, electromagnetic</p>
                </div>
                
                <div class="step">
                    <h4>Quantum Threat</h4>
                    <p><strong>Shor's Algorithm:</strong> Quantum computers can break RSA efficiently</p>
                    <p><strong>Timeline:</strong> Cryptographically relevant quantum computers expected in 10-30 years</p>
                    <p><strong>Solution:</strong> Post-quantum cryptography (lattice-based, hash-based)</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentN = 0, currentE = 0, currentD = 0, currentPhi = 0;
        
        // Prime number utilities
        function isPrime(n) {
            if (n < 2) return false;
            if (n === 2) return true;
            if (n % 2 === 0) return false;
            
            for (let i = 3; i * i <= n; i += 2) {
                if (n % i === 0) return false;
            }
            return true;
        }
        
        function getRandomPrime(min = 50, max = 200) {
            let candidate;
            do {
                candidate = Math.floor(Math.random() * (max - min + 1)) + min;
                if (candidate % 2 === 0) candidate++;
            } while (!isPrime(candidate));
            return candidate;
        }
        
        function generateRandomPrime(elementId) {
            const prime = getRandomPrime(50, 200);
            document.getElementById(elementId).value = prime;
            updateKeys();
        }
        
        // Mathematical utilities
        function gcd(a, b) {
            while (b !== 0) {
                let temp = b;
                b = a % b;
                a = temp;
            }
            return a;
        }
        
        function extendedGcd(a, b) {
            if (a === 0) return [b, 0, 1];
            
            let [gcd, x1, y1] = extendedGcd(b % a, a);
            let x = y1 - Math.floor(b / a) * x1;
            let y = x1;
            
            return [gcd, x, y];
        }
        
        function modInverse(e, phi) {
            let [gcd, x, y] = extendedGcd(e, phi);
            if (gcd !== 1) return null;
            return ((x % phi) + phi) % phi;
        }
        
        function modPow(base, exp, mod) {
            let result = 1;
            base = base % mod;
            while (exp > 0) {
                if (exp % 2 === 1) {
                    result = (result * base) % mod;
                }
                exp = Math.floor(exp / 2);
                base = (base * base) % mod;
            }
            return result;
        }
        
        function textToNumbers(text) {
            return text.split('').map(char => char.charCodeAt(0));
        }
        
        function numbersToText(numbers) {
            return numbers.map(num => String.fromCharCode(num)).join('');
        }
        
        // RSA Key Generation
        function generateKeys() {
            const p = parseInt(document.getElementById('primeP').value);
            const q = parseInt(document.getElementById('primeQ').value);
            const e = parseInt(document.getElementById('publicE').value);
            
            if (!isPrime(p) || !isPrime(q)) {
                alert('Both p and q must be prime numbers!');
                return;
            }
            
            if (p === q) {
                alert('p and q must be different primes!');
                return;
            }
            
            const n = p * q;
            const phi = (p - 1) * (q - 1);
            
            if (gcd(e, phi) !== 1) {
                alert('e must be coprime to œÜ(n)!');
                return;
            }
            
            const d = modInverse(e, phi);
            
            if (!d) {
                alert('Could not compute private exponent d!');
                return;
            }
            
            // Store values globally
            currentN = n;
            currentE = e;
            currentD = d;
            currentPhi = phi;
            
            // Update target for factorization
            document.getElementById('targetN').value = n;
            
            // Display results
            document.getElementById('keyResults').innerHTML = `
                <div class="math-display">
                    <p><strong>Primes:</strong> p = ${p}, q = ${q}</p>
                    <p><strong>Modulus:</strong> n = p √ó q = ${n}</p>
                    <p><strong>Totient:</strong> œÜ(n) = (p-1)(q-1) = ${phi}</p>
                    <p><strong>Public Key:</strong> (n=${n}, e=${e})</p>
                    <p><strong>Private Key:</strong> (n=${n}, d=${d})</p>
                    <p><strong>Verification:</strong> e √ó d mod œÜ(n) = ${(e * d) % phi}</p>
                </div>
            `;
            
            updateCalculationSteps(`
                <div class="step">
                    <h4>Key Generation Steps:</h4>
                    <p>1. Selected primes: p = ${p}, q = ${q}</p>
                    <p>2. Computed modulus: n = ${p} √ó ${q} = ${n}</p>
                    <p>3. Computed totient: œÜ(n) = (${p}-1) √ó (${q}-1) = ${phi}</p>
                    <p>4. Selected public exponent: e = ${e}</p>
                    <p>5. Computed private exponent: d = ${d} (such that ${e} √ó ${d} ‚â° 1 mod ${phi})</p>
                </div>
            `);
        }
        
        function encryptMessage() {
            if (currentN === 0) {
                alert('Generate keys first!');
                return;
            }
            
            const message = parseInt(document.getElementById('messageInput').value);
            
            if (message >= currentN) {
                alert(`Message must be less than n = ${currentN}!`);
                return;
            }
            
            const ciphertext = modPow(message, currentE, currentN);
            
            document.getElementById('cryptoResults').innerHTML = `
                <div class="math-display">
                    <p><strong>Plaintext:</strong> m = ${message}</p>
                    <p><strong>Encryption:</strong> c = m^e mod n = ${message}^${currentE} mod ${currentN}</p>
                    <p><strong>Ciphertext:</strong> c = ${ciphertext}</p>
                </div>
            `;
            
            updateCalculationSteps(`
                <div class="step">
                    <h4>Encryption Process:</h4>
                    <p>1. Message: m = ${message}</p>
                    <p>2. Public key: (n=${currentN}, e=${currentE})</p>
                    <p>3. Encryption formula: c = m^e mod n</p>
                    <p>4. Calculation: c = ${message}^${currentE} mod ${currentN}</p>
                    <p>5. Result: c = ${ciphertext}</p>
                    <p><strong>The encrypted message ${ciphertext} can be safely transmitted!</strong></p>
                </div>
            `);
        }
        
        function decryptMessage() {
            if (currentN === 0) {
                alert('Generate keys first!');
                return;
            }
            
            // Get ciphertext from encryption result or allow manual input
            const cryptoResults = document.getElementById('cryptoResults').innerHTML;
            const ciphertextMatch = cryptoResults.match(/Ciphertext:<\/strong> c = (\d+)/);
            
            if (!ciphertextMatch) {
                alert('Encrypt a message first to see decryption!');
                return;
            }
            
            const ciphertext = parseInt(ciphertextMatch[1]);
            const decrypted = modPow(ciphertext, currentD, currentN);
            
            document.getElementById('cryptoResults').innerHTML += `
                <div class="math-display" style="margin-top: 15px;">
                    <p><strong>Decryption:</strong> m = c^d mod n = ${ciphertext}^${currentD} mod ${currentN}</p>
                    <p><strong>Recovered Message:</strong> m = ${decrypted}</p>
                    <p style="color: #00ff88;"><strong>‚úÖ Decryption Successful!</strong></p>
                </div>
            `;
            
            updateCalculationSteps(`
                <div class="step">
                    <h4>Decryption Process:</h4>
                    <p>1. Received ciphertext: c = ${ciphertext}</p>
                    <p>2. Private key: (n=${currentN}, d=${currentD})</p>
                    <p>3. Decryption formula: m = c^d mod n</p>
                    <p>4. Calculation: m = ${ciphertext}^${currentD} mod ${currentN}</p>
                    <p>5. Result: m = ${decrypted}</p>
                    <p><strong>‚úÖ Original message recovered successfully!</strong></p>
                </div>
            `);
        }
        
        function convertTextToNumber() {
            const text = document.getElementById('textMessage').value.toUpperCase();
            if (text.length === 0) return;
            
            // Simple conversion: A=1, B=2, etc.
            const numbers = text.split('').map(char => {
                if (char >= 'A' && char <= 'Z') {
                    return char.charCodeAt(0) - 64; // A=1, B=2, ...
                }
                return 32; // Space or other characters
            });
            
            // Combine into single number (for demo purposes)
            let combined = 0;
            for (let i = 0; i < Math.min(numbers.length, 3); i++) { // Limit to 3 chars
                combined = combined * 100 + numbers[i];
            }
            
            document.getElementById('messageInput').value = combined;
            
            updateCalculationSteps(`
                <div class="step">
                    <h4>Text to Number Conversion:</h4>
                    <p>Text: "${text}"</p>
                    <p>Character codes: ${numbers.join(', ')}</p>
                    <p>Combined number: ${combined}</p>
                    <p><em>Note: In practice, longer messages are split into blocks.</em></p>
                </div>
            `);
        }
        
        function simulateFactorization() {
            const n = parseInt(document.getElementById('targetN').value);
            const startTime = performance.now();
            
            let factors = [];
            
            // Trial division for small numbers
            for (let i = 2; i * i <= n; i++) {
                if (n % i === 0) {
                    factors = [i, n / i];
                    break;
                }
            }
            
            const endTime = performance.now();
            const timeTaken = (endTime - startTime).toFixed(2);
            
            if (factors.length > 0) {
                document.getElementById('factorizationResults').innerHTML = `
                    <div class="math-display">
                        <p><strong>üí• RSA BROKEN!</strong></p>
                        <p><strong>n = ${n}</strong></p>
                        <p><strong>Factors found:</strong> ${factors[0]} √ó ${factors[1]} = ${n}</p>
                        <p><strong>Time taken:</strong> ${timeTaken} ms</p>
                        <p style="color: #ff4444;"><strong>‚ö†Ô∏è Private key can now be computed!</strong></p>
                    </div>
                    <div class="security-analysis">
                        <h4>üîì How to compute private key from factors:</h4>
                        <p>1. œÜ(n) = (${factors[0]}-1) √ó (${factors[1]}-1) = ${(factors[0]-1) * (factors[1]-1)}</p>
                        <p>2. d = e^(-1) mod œÜ(n)</p>
                        <p>3. Now attacker has (n, d) = private key!</p>
                    </div>
                `;
            } else {
                document.getElementById('factorizationResults').innerHTML = `
                    <div class="math-display">
                        <p><strong>üîí Factorization failed</strong></p>
                        <p>Could not factor n = ${n} in ${timeTaken} ms</p>
                        <p><em>Larger numbers would take exponentially longer</em></p>
                    </div>
                `;
            }
        }
        
        function updateCalculationSteps(content) {
            document.getElementById('calculationSteps').innerHTML = content;
        }
        
        function updateKeys() {
            // Auto-generate keys when inputs change
            setTimeout(generateKeys, 100);
        }
        
        function showSection(section) {
            // Hide all sections
            document.getElementById('theorySection').style.display = 'none';
            document.getElementById('demoSection').style.display = 'none';
            document.getElementById('securitySection').style.display = 'none';
            
            // Remove active class from all buttons
            document.querySelectorAll('.toggle-btn').forEach(btn => btn.classList.remove('active'));
            
            // Show selected section and activate button
            if (section === 'theory') {
                document.getElementById('theorySection').style.display = 'block';
                document.getElementById('theoryBtn').classList.add('active');
            } else if (section === 'demo') {
                document.getElementById('demoSection').style.display = 'block';
                document.getElementById('demoBtn').classList.add('active');
            } else if (section === 'security') {
                document.getElementById('securitySection').style.display = 'block';
                document.getElementById('securityBtn').classList.add('active');
            }
        }
        
        // Initialize
        window.onload = function() {
            generateKeys(); // Generate initial keys
            if (window.MathJax) {
                MathJax.typesetPromise();
            }
        };
    </script>
</body>
</html>
