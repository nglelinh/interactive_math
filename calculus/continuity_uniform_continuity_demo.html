<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Continuity and Uniform Continuity: Interactive Mathematical Foundation</title>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
  <script src="../math-simple.js"></script>
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$'], ['\\[', '\\]']]
      },
      svg: {
        fontCache: 'global'
      }
    };
  </script>
  <style>
    body {
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
      color: #ffffff;
      text-align: center;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      padding: 30px;
      font-size: 18px;
      line-height: 1.8;
      margin: 0;
      overflow-x: auto;
    }
    
    #container {
      display: flex;
      height: 100vh;
    }
    #canvas-container {
      flex: 1;
      position: relative;
    }
    #canvas {
      width: 100%;
      height: 100%;
      background: #333;
    }
    #info {
      width: 450px;
      background: rgba(0, 0, 0, 0.95);
      color: white;
      padding: 20px;
      overflow-y: auto;
      font-size: 14px;
    }
    h3 {
      color: #4CAF50;
      margin-top: 0;
    }
    .definition-section {
      margin-bottom: 20px;
      padding: 15px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 8px;
    }
    .continuity {
      border-left: 4px solid #2196F3;
    }
    .uniform-continuity {
      border-left: 4px solid #FF9800;
    }
    .example-section {
      border-left: 4px solid #9C27B0;
    }
    .theorem-section {
      border-left: 4px solid #4CAF50;
    }
    .control-group {
      margin-bottom: 15px;
    }
    label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
    }
    input[type="range"] {
      width: 100%;
      margin-bottom: 5px;
    }
    input[type="number"] {
      width: 60px;
      padding: 2px;
      margin: 0 5px;
    }
    button {
      background: #4CAF50;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 4px;
      cursor: pointer;
      margin: 5px;
    }
    button:hover {
      background: #45a049;
    }
    select {
      width: 100%;
      padding: 5px;
      margin-bottom: 10px;
      background: #444;
      color: white;
      border: 1px solid #666;
    }
    .value-display {
      color: #4CAF50;
      font-weight: bold;
    }
    .epsilon-delta {
      color: #FFC107;
      font-family: monospace;
      font-size: 12px;
    }
    .math-notation {
      font-family: "Times New Roman", serif;
      font-style: italic;
    }
    .point-info {
      background: rgba(33, 150, 243, 0.2);
      padding: 8px;
      border-radius: 4px;
      margin: 10px 0;
      font-size: 12px;
    }
    .status {
      font-weight: bold;
    }
    .continuous { color: #4CAF50; }
    .discontinuous { color: #f44336; }
    .uniformly-continuous { color: #FF9800; }
    .not-uniformly-continuous { color: #E91E63; }
    
    .function-curve { 
      stroke: #2196F3; 
      stroke-width: 2; 
      fill: none; 
    }
    .epsilon-band { 
      fill: rgba(76, 175, 80, 0.2); 
      stroke: #4CAF50; 
      stroke-width: 1; 
      stroke-dasharray: 5,5; 
    }
    .delta-interval { 
      fill: rgba(255, 193, 7, 0.3); 
      stroke: #FFC107; 
      stroke-width: 2; 
    }
    .test-point { 
      fill: #f44336; 
      stroke: white; 
      stroke-width: 2; 
    }
    .axis { 
      stroke: #666; 
      stroke-width: 1; 
    }
    .grid-line { 
      stroke: #444; 
      stroke-width: 0.5; 
    }
    .function-label {
      fill: white;
      font-size: 14px;
      font-family: Arial, sans-serif;
    }
    
    .formula-box {
      background: linear-gradient(145deg, rgba(15, 15, 40, 0.9), rgba(25, 25, 60, 0.7));
      padding: 25px 35px;
      border-radius: 15px;
      font-family: 'KaTeX_Main', 'Times New Roman', serif;
      font-size: 20px;
      line-height: 1.8;
      text-align: center;
      margin: 25px 0;
      border: 2px solid rgba(100, 200, 255, 0.4);
      box-shadow: 0 8px 25px rgba(0,0,0,0.4), inset 0 1px 0 rgba(255,255,255,0.1);
      position: relative;
      overflow: hidden;
      letter-spacing: 0.5px;
    }

    .formula-box::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, #00d4ff, #7c4dff, #ff6b6b, #4ecdc4);
      opacity: 0.8;
    }

    .formula-box .main-formula {
      font-size: 22px;
      font-weight: 600;
      margin-bottom: 8px;
      color: #ffffff;
      text-shadow: 0 0 10px rgba(255,255,255,0.3);
    }

    .formula-box .sub-formula {
      font-size: 16px;
      color: #b8e6ff;
      font-style: italic;
      margin-top: 8px;
    }

    .formula-box .formula-label {
      font-size: 14px;
      color: #ffeb3b;
      font-weight: 600;
      margin-bottom: 10px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .inline-formula {
      background: rgba(0, 0, 0, 0.3);
      padding: 4px 8px;
      border-radius: 6px;
      font-family: 'Times New Roman', serif;
      font-size: 16px;
      border: 1px solid rgba(255, 255, 255, 0.2);
      display: inline-block;
      margin: 0 2px;
      color: #e8f4fd;
    }
  </style>
</head>
<body>
  <h1 style="font-size: 3.2em; font-weight: 900; text-shadow: 4px 4px 8px rgba(0,0,0,0.8); margin-bottom: 40px; letter-spacing: 1px;">üìê Continuity & Uniform Continuity</h1>

  <!-- ===========================================
       THEORY SECTION
       =========================================== -->
  <div style="background: linear-gradient(145deg, rgba(25, 25, 60, 0.9), rgba(15, 15, 40, 0.7)); padding: 30px; border-radius: 15px; margin: 30px auto; max-width: 1200px; text-align: left; border: 2px solid rgba(100, 200, 255, 0.4);">
    <h2 style="color: #00d4ff; font-size: 2.5em; margin-bottom: 20px; text-align: center; text-shadow: 2px 2px 4px rgba(0,0,0,0.8);">üìñ L√ù THUY·∫æT</h2>
    
    <div class="math-section" style="background: rgba(255, 215, 0, 0.15); padding: 20px; border-radius: 10px; margin-bottom: 25px; border-left: 4px solid #FFD700;">
      <h3 style="color: #FFD700; margin-top: 0;">üìö Mathematical Foundation</h3>
      
      <div class="definition-box" style="background: linear-gradient(145deg, #e3f2fd, #bbdefb); color: #333; padding: 20px; border-radius: 10px; margin: 15px 0; border: 1px solid #2196f3;">
        <h4>Fundamental Concepts</h4>
        <p><strong>Continuity</strong> captures the intuitive notion that small changes in input produce small changes in output. It's a <em>local</em> property - we examine behavior near each individual point.</p>
        <p><strong>Uniform Continuity</strong> strengthens this: the same Œ¥ works for the same Œµ everywhere on the domain. It's a <em>global</em> property of the entire function.</p>
        
        <h4>üéØ Key Insight</h4>
        <p>The difference lies in <em>quantifier order</em>:</p>
        <ul>
          <li><strong>Continuity:</strong> For each point, then for each Œµ, find a Œ¥</li>
          <li><strong>Uniform Continuity:</strong> For each Œµ, find one Œ¥ that works everywhere</li>
        </ul>
      </div>
    </div>
    
    <div class="definition-section continuity">
      <h4>Continuity at a Point</h4>
      <div>A function $f$ is <strong>continuous</strong> at $x_0$ if:</div>
      <div class="formula-container">
        <div class="formula-title">Definition of Continuity</div>
        <div class="math-environment">
          $$\forall \varepsilon > 0, \exists \delta > 0 \text{ such that}$$
          $$|x - x_0| < \delta \Rightarrow |f(x) - f(x_0)| < \varepsilon$$
        </div>
        <div class="formula-description">$\delta$ can depend on both $\varepsilon$ and $x_0$</div>
      </div>
    </div>

    <div class="definition-section uniform-continuity">
      <h4>Uniform Continuity</h4>
      <div>A function $f$ is <strong>uniformly continuous</strong> if:</div>
      <div class="formula-container">
        <div class="formula-title">Definition of Uniform Continuity</div>
        <div class="math-environment">
          $$\forall \varepsilon > 0, \exists \delta > 0 \text{ such that } \forall x,y:$$
          $$|x - y| < \delta \Rightarrow |f(x) - f(y)| < \varepsilon$$
        </div>
        <div class="formula-description">$\delta$ depends only on $\varepsilon$, not on the point</div>
      </div>
    </div>
    
    <div class="theorem-section" style="background: linear-gradient(145deg, #f3e5f5, #e1bee7); color: #333; padding: 20px; border-radius: 10px; margin: 15px 0; border: 1px solid #9c27b0;">
      <h3>üéì Fundamental Theorems</h3>
      
      <div class="example-box" style="background: linear-gradient(145deg, #e8f5e8, #c8e6c9); padding: 15px; border-radius: 8px; margin: 10px 0; border: 1px solid #4caf50;">
        <h4>Theorem 1: Relationship Between Continuities</h4>
        <p><strong>Uniform Continuity ‚üπ Continuity</strong></p>
        <p><strong>Proof:</strong> If $f$ is uniformly continuous, then for any $x_0$ and any $\varepsilon > 0$, there exists $\delta > 0$ such that for all $x,y$ with $|x-y| < \delta$, we have $|f(x) - f(y)| < \varepsilon$. Taking $y = x_0$ gives continuity at $x_0$. Since $x_0$ was arbitrary, $f$ is continuous everywhere. ‚ñ°</p>
      </div>
      
      <div class="example-box" style="background: linear-gradient(145deg, #e8f5e8, #c8e6c9); padding: 15px; border-radius: 8px; margin: 10px 0; border: 1px solid #4caf50;">
        <h4>Theorem 2: Heine-Cantor Theorem</h4>
        <p><strong>Continuous on Compact Set ‚üπ Uniformly Continuous</strong></p>
        <p><strong>Statement:</strong> If $f: K \to \mathbb{R}$ is continuous and $K$ is compact, then $f$ is uniformly continuous on $K$.</p>
      </div>
      
      <div class="example-box" style="background: linear-gradient(145deg, #e8f5e8, #c8e6c9); padding: 15px; border-radius: 8px; margin: 10px 0; border: 1px solid #4caf50;">
        <h4>Theorem 3: Lipschitz Continuity</h4>
        <p><strong>Lipschitz Continuous ‚üπ Uniformly Continuous</strong></p>
        <p><strong>Definition:</strong> $f$ is Lipschitz continuous if $\exists L > 0$ such that $|f(x) - f(y)| \leq L|x - y|$ for all $x,y$.</p>
        <p><strong>Proof:</strong> Given $\varepsilon > 0$, choose $\delta = \varepsilon/L$. Then $|x - y| < \delta \Rightarrow |f(x) - f(y)| \leq L|x - y| < L \cdot \frac{\varepsilon}{L} = \varepsilon$. ‚ñ°</p>
      </div>
    </div>

    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(450px, 1fr)); gap: 20px; margin-top: 20px;">
      <div style="background: rgba(76, 175, 80, 0.1); padding: 15px; border-radius: 8px; border: 1px solid #4caf50;">
        <h4 style="color: #28a745;">‚úÖ Uniformly Continuous Functions</h4>
        <p><strong>1. Linear Functions:</strong> $f(x) = ax + b$</p>
        <p>$|f(x) - f(y)| = |a||x - y|$, so choose $\delta = \varepsilon/|a|$ (if $a \neq 0$)</p>
        
        <p><strong>2. Sine and Cosine:</strong> $f(x) = \sin(x)$ or $\cos(x)$</p>
        <p>$|\sin(x) - \sin(y)| \leq |x - y|$ by mean value theorem, so $\delta = \varepsilon$</p>
        
        <p><strong>3. Square Root:</strong> $f(x) = \sqrt{x}$ on $[0,\infty)$</p>
        <p>Choose $\delta = \varepsilon^2$ for $\varepsilon \leq 1$</p>
      </div>
      
      <div style="background: rgba(244, 67, 54, 0.1); padding: 15px; border-radius: 8px; border: 1px solid #f44336;">
        <h4 style="color: #dc3545;">‚ùå Not Uniformly Continuous</h4>
        <p><strong>1. Quadratic Function:</strong> $f(x) = x^2$ on $\mathbb{R}$</p>
        <p>Take $x_n = n$, $y_n = n + 1/n$. Then $|x_n - y_n| = 1/n \to 0$</p>
        <p>But $|f(x_n) - f(y_n)| = 2 + 1/n^2 \to 2 \not\to 0$</p>
        
        <p><strong>2. Reciprocal Function:</strong> $f(x) = 1/x$ on $(0,1]$</p>
        <p>Take $x_n = 1/n$, $y_n = 1/(n+1)$</p>
        <p>But $|f(x_n) - f(y_n)| = 1 \not\to 0$</p>
        
        <p><strong>3. Exponential Function:</strong> $f(x) = e^x$ on $\mathbb{R}$</p>
        <p>$f'(x) = e^x$ is unbounded, so not uniformly continuous</p>
      </div>
    </div>
  </div>

  <!-- ===========================================
       INTERACTIVE ILLUSTRATION SECTION
       =========================================== -->
  <div id="container" style="background: linear-gradient(145deg, rgba(15, 40, 15, 0.9), rgba(25, 60, 25, 0.7)); border-radius: 15px; margin: 30px auto; max-width: 1400px; border: 2px solid rgba(76, 175, 80, 0.4); height: 600px;">
    <div id="canvas-container">
      <svg id="canvas"></svg>
    </div>
    
    <div id="info">
      <h2 style="color: #4caf50; font-size: 1.8em; margin-bottom: 20px; text-align: center;">üéÆ MINH H·ªåA T∆Ø∆†NG T√ÅC</h2>
      
      <div style="text-align: center; margin-bottom: 20px; background: rgba(76, 175, 80, 0.1); padding: 15px; border-radius: 10px;">
        <p style="font-size: 16px; color: #81c784; margin: 0;">Kh√°m ph√° tr·ª±c quan c√°c kh√°i ni·ªám li√™n t·ª•c v√† li√™n t·ª•c ƒë·ªÅu th√¥ng qua bi·ªÉu di·ªÖn ƒë·ªì th·ªã ƒë·ªông v√† t∆∞∆°ng t√°c epsilon-delta</p>
      </div>

      <div class="control-group">
        <label>Function:</label>
        <select id="functionSelect">
          <optgroup label="üìà Uniformly Continuous">
            <option value="linear">Linear: f(x) = x</option>
            <option value="sin">Sine: f(x) = sin(x)</option>
            <option value="abs">Absolute Value: f(x) = |x|</option>
            <option value="sqrt">Square Root: f(x) = ‚àöx</option>
            <option value="logistic">Logistic: f(x) = 1/(1+e^(-x))</option>
            <option value="rational">Rational: f(x) = x/(1+x¬≤)</option>
          </optgroup>
          <optgroup label="üìâ Not Uniformly Continuous">
            <option value="quadratic">Quadratic: f(x) = x¬≤</option>
            <option value="cubic">Cubic: f(x) = x¬≥</option>
            <option value="exp">Exponential: f(x) = e^x</option>
            <option value="reciprocal">Reciprocal: f(x) = 1/x</option>
            <option value="tan">Tangent: f(x) = tan(x)</option>
          </optgroup>
          <optgroup label="üö´ Discontinuous">
            <option value="step">Step Function</option>
          </optgroup>
        </select>
      </div>

      <div class="control-group">
        <label>Test Point (x‚ÇÄ):</label>
        <input type="range" id="testPoint" min="-3" max="3" step="0.1" value="1">
        <span id="testPointValue">1.0</span>
      </div>

      <div class="control-group">
        <label>Epsilon (Œµ):</label>
        <input type="range" id="epsilon" min="0.1" max="2" step="0.1" value="0.5">
        <span id="epsilonValue">0.5</span>
      </div>

      <div class="control-group">
        <label>Delta (Œ¥):</label>
        <input type="range" id="delta" min="0.1" max="2" step="0.1" value="0.5">
        <span id="deltaValue">0.5</span>
      </div>

      <div class="control-group">
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
          <button id="findDeltaBtn" style="background: #2196F3;">üéØ Find Required Œ¥</button>
          <button id="testUniformBtn" style="background: #FF9800;">üß™ Test Uniform Continuity</button>
        </div>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 10px;">
          <button id="animateBtn" style="background: #9C27B0;">üé¨ Animate Œµ-Œ¥</button>
          <button id="compareBtn" style="background: #4CAF50;">üìä Compare Functions</button>
        </div>
      </div>

      <div class="point-info">
        <strong>At Current Point:</strong><br>
        <div>x‚ÇÄ = <span id="currentX0" class="value-display">1.0</span></div>
        <div>f(x‚ÇÄ) = <span id="currentF0" class="value-display">1.0</span></div>
        <div>Continuity: <span id="continuityStat" class="continuous">Continuous</span></div>
        <div>Required Œ¥: <span id="requiredDelta" class="value-display">N/A</span></div>
      </div>

      <div class="definition-section example-section">
        <h4>Current Analysis</h4>
        <div>Function: <span id="functionName" class="value-display">f(x) = x</span></div>
        <div>Domain: <span id="domainInfo" class="value-display">‚Ñù</span></div>
        <div>Uniform Continuity: <span id="uniformStatus" class="uniformly-continuous">Yes</span></div>
        <div id="uniformReason" style="font-size: 12px; margin-top: 5px;"></div>
      </div>

      <div class="control-group">
        <input type="checkbox" id="showEpsilonBand" checked> Show Œµ-neighborhood
        <input type="checkbox" id="showDeltaInterval" checked> Show Œ¥-interval
        <input type="checkbox" id="showGrid" checked> Show Grid
      </div>

      <div style="background: rgba(156, 39, 176, 0.1); padding: 15px; border-radius: 8px; margin: 15px 0; border: 1px solid #9c27b0;">
        <h4>üéÆ Interactive Instructions</h4>
        <div style="display: grid; grid-template-columns: 1fr; gap: 10px; margin: 15px 0;">
          <div style="background: rgba(76, 175, 80, 0.1); padding: 10px; border-radius: 5px;">
            <strong>üéØ Visualization Guide</strong>
            <div>‚Ä¢ <span style="color: #4CAF50;">Green band:</span> Œµ-neighborhood of f(x‚ÇÄ)</div>
            <div>‚Ä¢ <span style="color: #FFC107;">Yellow region:</span> Œ¥-neighborhood of x‚ÇÄ</div>
            <div>‚Ä¢ <span style="color: #f44336;">Red dot:</span> Current test point</div>
            <div>‚Ä¢ <span style="color: #2196F3;">Blue curve:</span> Function graph</div>
          </div>
        </div>
        
        <div style="background: rgba(156, 39, 176, 0.1); padding: 15px; border-radius: 8px; margin: 15px 0; border: 1px solid #9c27b0;">
          <h4>üß™ Experimental Suggestions</h4>
          <div><strong>1. Explore Quadratic Function:</strong> Try x¬≤ at different points. Notice how Œ¥ gets smaller as |x| increases.</div>
          <div><strong>2. Test Reciprocal Function:</strong> Try 1/x near x=0. See how no finite Œ¥ works uniformly.</div>
          <div><strong>3. Compare Linear vs Quadratic:</strong> Linear functions need the same Œ¥ everywhere; quadratic functions don't.</div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const svg = document.getElementById('canvas');
    const container = document.getElementById('canvas-container');
    
    // Function parameters
    let currentFunction = 'linear';
    let testPoint = 1.0;
    let epsilon = 0.5;
    let delta = 0.5;
    
    // Function definitions
    const functions = {
      linear: {
        f: x => x,
        name: 'f(x) = x',
        domain: '‚Ñù',
        uniformlyContinuous: true,
        reason: 'Linear functions are Lipschitz continuous with L = 1'
      },
      quadratic: {
        f: x => x * x,
        name: 'f(x) = x¬≤',
        domain: '‚Ñù',
        uniformlyContinuous: false,
        reason: 'f\'(x) = 2x is unbounded on ‚Ñù'
      },
      cubic: {
        f: x => x * x * x,
        name: 'f(x) = x¬≥',
        domain: '‚Ñù',
        uniformlyContinuous: false,
        reason: 'f\'(x) = 3x¬≤ is unbounded on ‚Ñù'
      },
      sqrt: {
        f: x => x >= 0 ? Math.sqrt(x) : NaN,
        name: 'f(x) = ‚àöx',
        domain: '[0,‚àû)',
        uniformlyContinuous: true,
        reason: 'f\'(x) = 1/(2‚àöx) ‚Üí 0 as x ‚Üí ‚àû, bounded on [Œ¥,‚àû) for any Œ¥ > 0'
      },
      reciprocal: {
        f: x => x !== 0 ? 1/x : NaN,
        name: 'f(x) = 1/x',
        domain: '‚Ñù \\ {0}',
        uniformlyContinuous: false,
        reason: 'Not uniformly continuous on (0,1]: as x ‚Üí 0‚Å∫, |f\'(x)| ‚Üí ‚àû'
      },
      logistic: {
        f: x => 1 / (1 + Math.exp(-x)),
        name: 'f(x) = 1/(1+e^(-x))',
        domain: '‚Ñù',
        uniformlyContinuous: true,
        reason: 'Logistic function has bounded derivative: |f\'(x)| ‚â§ 1/4'
      },
      rational: {
        f: x => x / (1 + x*x),
        name: 'f(x) = x/(1+x¬≤)',
        domain: '‚Ñù',
        uniformlyContinuous: true,
        reason: 'Bounded function with bounded derivative'
      },
      exp: {
        f: x => Math.exp(x),
        name: 'f(x) = eÀ£',
        domain: '‚Ñù',
        uniformlyContinuous: false,
        reason: 'f\'(x) = eÀ£ is unbounded on ‚Ñù'
      },
      sin: {
        f: x => Math.sin(x),
        name: 'f(x) = sin(x)',
        domain: '‚Ñù',
        uniformlyContinuous: true,
        reason: '|f\'(x)| = |cos(x)| ‚â§ 1, so f is Lipschitz continuous'
      },
      tan: {
        f: x => Math.tan(x),
        name: 'f(x) = tan(x)',
        domain: '‚Ñù \\ {œÄ/2 + nœÄ}',
        uniformlyContinuous: false,
        reason: 'f\'(x) = sec¬≤(x) is unbounded near x = œÄ/2 + nœÄ'
      },
      abs: {
        f: x => Math.abs(x),
        name: 'f(x) = |x|',
        domain: '‚Ñù',
        uniformlyContinuous: true,
        reason: '|f(x) - f(y)| = ||x| - |y|| ‚â§ |x - y|, so f is Lipschitz continuous'
      },
      step: {
        f: x => x >= 0 ? 1 : 0,
        name: 'f(x) = step function',
        domain: '‚Ñù',
        uniformlyContinuous: false,
        reason: 'Discontinuous at x = 0'
      }
    };

    // Setup SVG
    function setupSVG() {
      const rect = container.getBoundingClientRect();
      svg.setAttribute('width', rect.width);
      svg.setAttribute('height', rect.height);
      svg.setAttribute('viewBox', `0 0 ${rect.width} ${rect.height}`);
    }

    // Coordinate transformation
    function toSVG(x, y) {
      const rect = container.getBoundingClientRect();
      const margin = 50;
      const xRange = 6; // -3 to 3
      const yRange = 6; // -3 to 3
      
      const scaleX = (rect.width - 2 * margin) / xRange;
      const scaleY = (rect.height - 2 * margin) / yRange;
      
      return {
        x: margin + (x + 3) * scaleX,
        y: rect.height - margin - (y + 3) * scaleY
      };
    }

    function fromSVG(svgX, svgY) {
      const rect = container.getBoundingClientRect();
      const margin = 50;
      const xRange = 6;
      const yRange = 6;
      
      const scaleX = (rect.width - 2 * margin) / xRange;
      const scaleY = (rect.height - 2 * margin) / yRange;
      
      return {
        x: (svgX - margin) / scaleX - 3,
        y: -((svgY - (rect.height - margin)) / scaleY - 3)
      };
    }

    // Draw grid
    function drawGrid() {
      if (!document.getElementById('showGrid').checked) return;
      
      // Vertical grid lines
      for (let x = -3; x <= 3; x += 0.5) {
        const start = toSVG(x, -3);
        const end = toSVG(x, 3);
        
        const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
        line.setAttribute('x1', start.x);
        line.setAttribute('y1', start.y);
        line.setAttribute('x2', end.x);
        line.setAttribute('y2', end.y);
        line.setAttribute('class', x === 0 ? 'axis' : 'grid-line');
        svg.appendChild(line);
      }
      
      // Horizontal grid lines
      for (let y = -3; y <= 3; y += 0.5) {
        const start = toSVG(-3, y);
        const end = toSVG(3, y);
        
        const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
        line.setAttribute('x1', start.x);
        line.setAttribute('y1', start.y);
        line.setAttribute('x2', end.x);
        line.setAttribute('y2', end.y);
        line.setAttribute('class', y === 0 ? 'axis' : 'grid-line');
        svg.appendChild(line);
      }
    }

    // Draw function
    function drawFunction() {
      const func = functions[currentFunction];
      const points = [];
      
      for (let x = -3; x <= 3; x += 0.01) {
        const y = func.f(x);
        if (!isNaN(y) && Math.abs(y) <= 10) {
          const svgPoint = toSVG(x, Math.max(-3, Math.min(3, y)));
          points.push(`${svgPoint.x},${svgPoint.y}`);
        }
      }
      
      if (points.length > 0) {
        const polyline = document.createElementNS('http://www.w3.org/2000/svg', 'polyline');
        polyline.setAttribute('points', points.join(' '));
        polyline.setAttribute('class', 'function-curve');
        svg.appendChild(polyline);
      }
    }

    // Draw epsilon band
    function drawEpsilonBand() {
      if (!document.getElementById('showEpsilonBand').checked) return;
      
      const func = functions[currentFunction];
      const f0 = func.f(testPoint);
      
      if (isNaN(f0)) return;
      
      const upperY = f0 + epsilon;
      const lowerY = f0 - epsilon;
      
      const startPoint = toSVG(-3, Math.max(-3, Math.min(3, upperY)));
      const width = toSVG(3, 0).x - toSVG(-3, 0).x;
      const height = Math.abs(toSVG(0, upperY).y - toSVG(0, lowerY).y);
      
      const rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
      rect.setAttribute('x', startPoint.x);
      rect.setAttribute('y', Math.min(toSVG(0, upperY).y, toSVG(0, lowerY).y));
      rect.setAttribute('width', width);
      rect.setAttribute('height', height);
      rect.setAttribute('class', 'epsilon-band');
      svg.appendChild(rect);
    }

    // Draw delta interval
    function drawDeltaInterval() {
      if (!document.getElementById('showDeltaInterval').checked) return;
      
      const leftX = testPoint - delta;
      const rightX = testPoint + delta;
      
      const leftPoint = toSVG(leftX, -3);
      const rightPoint = toSVG(rightX, -3);
      const width = rightPoint.x - leftPoint.x;
      const height = toSVG(0, 3).y - toSVG(0, -3).y;
      
      const rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
      rect.setAttribute('x', leftPoint.x);
      rect.setAttribute('y', toSVG(0, 3).y);
      rect.setAttribute('width', width);
      rect.setAttribute('height', height);
      rect.setAttribute('class', 'delta-interval');
      svg.appendChild(rect);
    }

    // Draw test point
    function drawTestPoint() {
      const func = functions[currentFunction];
      const f0 = func.f(testPoint);
      
      if (isNaN(f0)) return;
      
      const point = toSVG(testPoint, f0);
      
      const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
      circle.setAttribute('cx', point.x);
      circle.setAttribute('cy', point.y);
      circle.setAttribute('r', 5);
      circle.setAttribute('class', 'test-point');
      svg.appendChild(circle);
    }

    // Update display
    function updateDisplay() {
      // Clear SVG
      svg.innerHTML = '';
      
      // Draw everything
      drawGrid();
      drawEpsilonBand();
      drawDeltaInterval();
      drawFunction();
      drawTestPoint();
      
      // Update text displays
      const func = functions[currentFunction];
      const f0 = func.f(testPoint);
      
      document.getElementById('functionName').textContent = func.name;
      document.getElementById('domainInfo').textContent = func.domain;
      document.getElementById('uniformStatus').textContent = func.uniformlyContinuous ? 'Yes' : 'No';
      document.getElementById('uniformStatus').className = func.uniformlyContinuous ? 'uniformly-continuous' : 'not-uniformly-continuous';
      document.getElementById('uniformReason').textContent = func.reason;
      
      document.getElementById('currentX0').textContent = testPoint.toFixed(2);
      document.getElementById('currentF0').textContent = isNaN(f0) ? 'Undefined' : f0.toFixed(3);
      
      // Check continuity at current point
      const isContinuous = !isNaN(f0) && currentFunction !== 'step' || (currentFunction === 'step' && testPoint !== 0);
      document.getElementById('continuityStat').textContent = isContinuous ? 'Continuous' : 'Discontinuous';
      document.getElementById('continuityStat').className = isContinuous ? 'continuous' : 'discontinuous';
      
      // Calculate required delta
      calculateRequiredDelta();
    }

    // Calculate required delta for given epsilon
    function calculateRequiredDelta() {
      const func = functions[currentFunction];
      const f0 = func.f(testPoint);
      
      if (isNaN(f0) || currentFunction === 'step') {
        document.getElementById('requiredDelta').textContent = 'N/A';
        return;
      }
      
      let requiredDelta = 0.1;
      
      // For different functions, calculate theoretical delta
      switch (currentFunction) {
        case 'linear':
          requiredDelta = epsilon; // Lipschitz with L=1
          break;
        case 'quadratic':
          requiredDelta = epsilon / (2 * Math.abs(testPoint) + epsilon);
          break;
        case 'sin':
          requiredDelta = epsilon; // Lipschitz with L=1
          break;
        case 'abs':
          requiredDelta = epsilon; // Lipschitz with L=1
          break;
        default:
          // Numerical approximation
          for (let d = 0.01; d <= 2; d += 0.01) {
            let maxDiff = 0;
            for (let x = testPoint - d; x <= testPoint + d; x += 0.01) {
              const fx = func.f(x);
              if (!isNaN(fx)) {
                maxDiff = Math.max(maxDiff, Math.abs(fx - f0));
              }
            }
            if (maxDiff <= epsilon) {
              requiredDelta = d;
              break;
            }
          }
      }
      
      document.getElementById('requiredDelta').textContent = requiredDelta.toFixed(3);
    }

    // Find optimal delta
    function findDelta() {
      calculateRequiredDelta();
      const requiredDelta = parseFloat(document.getElementById('requiredDelta').textContent);
      if (!isNaN(requiredDelta)) {
        delta = Math.min(requiredDelta, 2);
        document.getElementById('delta').value = delta;
        document.getElementById('deltaValue').textContent = delta.toFixed(1);
        updateDisplay();
      }
    }

    // Test uniform continuity
    function testUniformContinuity() {
      const func = functions[currentFunction];
      let isUniform = true;
      let problemPoint = null;
      
      // Test multiple points
      for (let x1 = -2.5; x1 <= 2.5 && isUniform; x1 += 0.5) {
        for (let x2 = x1 + 0.1; x2 <= x1 + delta && x2 <= 3; x2 += 0.1) {
          const f1 = func.f(x1);
          const f2 = func.f(x2);
          
          if (!isNaN(f1) && !isNaN(f2)) {
            if (Math.abs(f2 - f1) > epsilon) {
              isUniform = false;
              problemPoint = {x1, x2, f1, f2};
              break;
            }
          }
        }
      }
      
      const statusText = isUniform ? 'PASSED: Œ¥ works for all points' : 
                        `FAILED: Found points where |f(x‚ÇÅ)-f(x‚ÇÇ)| > Œµ`;
      
      alert(statusText);
    }

    // Animation for epsilon-delta
    let animationRunning = false;
    function animateEpsilonDelta() {
      if (animationRunning) {
        animationRunning = false;
        document.getElementById('animateBtn').textContent = 'üé¨ Animate Œµ-Œ¥';
        return;
      }
      
      animationRunning = true;
      document.getElementById('animateBtn').textContent = '‚èπÔ∏è Stop Animation';
      
      let step = 0;
      const maxSteps = 100;
      
      function animate() {
        if (!animationRunning) return;
        
        const t = (Math.sin(step * 0.1) + 1) / 2;
        epsilon = 0.1 + t * 1.5;
        
        document.getElementById('epsilon').value = epsilon;
        document.getElementById('epsilonValue').textContent = epsilon.toFixed(1);
        
        calculateRequiredDelta();
        const requiredDelta = parseFloat(document.getElementById('requiredDelta').textContent);
        if (!isNaN(requiredDelta)) {
          delta = Math.min(requiredDelta, 2);
          document.getElementById('delta').value = delta;
          document.getElementById('deltaValue').textContent = delta.toFixed(1);
        }
        
        updateDisplay();
        
        step++;
        if (step < maxSteps && animationRunning) {
          setTimeout(animate, 100);
        } else {
          animationRunning = false;
          document.getElementById('animateBtn').textContent = 'üé¨ Animate Œµ-Œ¥';
        }
      }
      
      animate();
    }

    // Compare multiple functions
    function compareFunctions() {
      const testFunctions = ['linear', 'quadratic', 'sin', 'reciprocal'];
      let comparison = "üìä Function Comparison (for Œµ = 0.5):\n\n";
      
      testFunctions.forEach(funcName => {
        const func = functions[funcName];
        if (func) {
          comparison += `${func.name}:\n`;
          comparison += `  Uniformly Continuous: ${func.uniformlyContinuous ? 'Yes' : 'No'}\n`;
          comparison += `  Reason: ${func.reason}\n\n`;
        }
      });
      
      alert(comparison);
    }

    // Event listeners
    document.getElementById('functionSelect').addEventListener('change', (e) => {
      currentFunction = e.target.value;
      updateDisplay();
    });

    document.getElementById('testPoint').addEventListener('input', (e) => {
      testPoint = parseFloat(e.target.value);
      document.getElementById('testPointValue').textContent = testPoint.toFixed(1);
      updateDisplay();
    });

    document.getElementById('epsilon').addEventListener('input', (e) => {
      epsilon = parseFloat(e.target.value);
      document.getElementById('epsilonValue').textContent = epsilon.toFixed(1);
      updateDisplay();
    });

    document.getElementById('delta').addEventListener('input', (e) => {
      delta = parseFloat(e.target.value);
      document.getElementById('deltaValue').textContent = delta.toFixed(1);
      updateDisplay();
    });

    document.getElementById('findDeltaBtn').addEventListener('click', findDelta);
    document.getElementById('testUniformBtn').addEventListener('click', testUniformContinuity);
    document.getElementById('animateBtn').addEventListener('click', animateEpsilonDelta);
    document.getElementById('compareBtn').addEventListener('click', compareFunctions);

    document.getElementById('showEpsilonBand').addEventListener('change', updateDisplay);
    document.getElementById('showDeltaInterval').addEventListener('change', updateDisplay);
    document.getElementById('showGrid').addEventListener('change', updateDisplay);

    // Mouse interaction for setting test point
    svg.addEventListener('click', (event) => {
      const rect = svg.getBoundingClientRect();
      const svgX = event.clientX - rect.left;
      const svgY = event.clientY - rect.top;
      const coords = fromSVG(svgX, svgY);
      
      if (coords.x >= -3 && coords.x <= 3) {
        testPoint = coords.x;
        document.getElementById('testPoint').value = testPoint;
        document.getElementById('testPointValue').textContent = testPoint.toFixed(1);
        updateDisplay();
      }
    });

    // Window resize
    window.addEventListener('resize', () => {
      setupSVG();
      updateDisplay();
    });

    // Initialize
    setupSVG();
    updateDisplay();
    
    // Initialize MathJax
    document.addEventListener('DOMContentLoaded', function() {
      if (window.MathJax && window.MathJax.typesetPromise) {
        MathJax.typesetPromise().then(() => {
          console.log('MathJax typesetting complete for continuity demo');
        }).catch((err) => console.log('MathJax typeset failed: ' + err.message));
      }
    });
  </script>
</body>
</html>