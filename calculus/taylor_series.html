<!DOCTYPE html>
<html>
<head>
    <title>Taylor Series</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 20px; 
            background: #ffffff;
            font-size: 20px;
            line-height: 1.6;
            color: #000000;
        }
        .section { 
            margin-bottom: 40px; 
            background: #f8f9fa;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            border: 2px solid #e9ecef;
        }
        .toggle-buttons {
            margin-bottom: 30px;
            text-align: center;
        }
        .toggle-btn {
            padding: 20px 40px;
            margin: 0 10px;
            background: #0056b3;
            color: white;
            border: 3px solid #0056b3;
            border-radius: 8px;
            cursor: pointer;
            font-size: 24px;
            font-weight: bold;
            transition: all 0.3s;
            text-transform: uppercase;
        }
        .toggle-btn:hover {
            background: #004085;
            border-color: #004085;
            transform: scale(1.05);
        }
        .toggle-btn.active {
            background: #dc3545;
            border-color: #dc3545;
            box-shadow: 0 4px 8px rgba(220, 53, 69, 0.3);
        }
        .example { 
            background: #fff3cd; 
            padding: 25px; 
            border-radius: 10px; 
            margin: 30px 0; 
            border-left: 6px solid #856404;
            font-size: 18px;
            border: 2px solid #ffeaa7;
        }
        canvas { 
            border: 3px solid #000000; 
            margin-top: 30px; 
            display: block;
            margin-left: auto;
            margin-right: auto;
            background: #ffffff;
        }
        .theory { 
            background: #e3f2fd; 
            padding: 30px; 
            border-radius: 12px; 
            border: 2px solid #1976d2;
        }
        .control-panel {
            text-align: center;
            margin: 30px 0;
            padding: 25px;
            background: #f1f3f4;
            border-radius: 12px;
            border: 2px solid #9aa0a6;
        }
        .control-panel label {
            font-weight: bold;
            margin-right: 15px;
            font-size: 22px;
            color: #1a73e8;
        }
        .control-panel input[type="range"] {
            width: 400px;
            height: 8px;
            margin: 0 15px;
            -webkit-appearance: none;
            background: #ddd;
            border-radius: 5px;
        }
        .control-panel input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 25px;
            height: 25px;
            background: #1a73e8;
            cursor: pointer;
            border-radius: 50%;
        }
        #orderValue {
            font-weight: bold;
            color: #dc3545;
            font-size: 28px;
            background: #fff;
            padding: 8px 16px;
            border-radius: 8px;
            border: 2px solid #dc3545;
        }
        h1 {
            font-size: 48px;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }
        h2 {
            font-size: 36px;
            color: #1976d2;
            margin-bottom: 25px;
            border-bottom: 3px solid #1976d2;
            padding-bottom: 10px;
        }
        h3 {
            font-size: 28px;
            color: #2e7d32;
            margin-top: 30px;
            margin-bottom: 20px;
        }
        p {
            font-size: 20px;
            margin-bottom: 20px;
        }
        li {
            font-size: 18px;
            margin-bottom: 10px;
        }
        b {
            font-size: 22px;
            color: #1565c0;
        }
        i {
            font-size: 16px;
            color: #555;
        }
    </style>
</head>
<body>
    <h1 style="text-align: center; color: #333;">Taylor Series</h1>
    
    <div class="toggle-buttons">
        <button class="toggle-btn active" id="theoryBtn" onclick="showSection('theory')">Theory</button>
        <button class="toggle-btn" id="illustrationBtn" onclick="showSection('illustration')">Illustration</button>
    </div>

    <div id="theorySection" class="section theory">
        <h2>Theory</h2>
        <p>
            The Taylor series is a representation of a function as an infinite sum of terms, each term being derived from the derivatives of the function at a single point. It is a cornerstone of mathematical analysis, providing polynomial approximations to functions that are infinitely differentiable at a point.
        </p>
        <p>
            <b>General Form:</b><br>
            For a function \( f(x) \) that is infinitely differentiable at \( x = a \), the Taylor series expansion about \( a \) is:
        </p>
        <p style="font-size: 1.2em; text-align: center;">
            \[
                f(x) = \sum_{n=0}^{\infty} \frac{f^{(n)}(a)}{n!} (x-a)^n
            \]
        </p>
        <p>
            <b>Special Case: Maclaurin Series</b><br>
            When \( a = 0 \), the Taylor series is called the Maclaurin series:
        </p>
        <p style="font-size: 1.2em; text-align: center;">
            \[
                f(x) = \sum_{n=0}^{\infty} \frac{f^{(n)}(0)}{n!} x^n
            \]
        </p>
        
        <h3>Why Taylor Series?</h3>
        <ul>
            <li>Approximates complicated functions with polynomials</li>
            <li>Used in numerical methods, physics, engineering, and computer science</li>
            <li>Helps analyze local behavior of functions</li>
            <li>Foundation for many computational algorithms</li>
        </ul>
        
        <h3>Common Examples</h3>
        <div class="example">
            <b>Example 1: Taylor Series for \( e^x \) at \( a = 0 \)</b><br>
            \[
                e^x = 1 + x + \frac{x^2}{2!} + \frac{x^3}{3!} + \frac{x^4}{4!} + \cdots = \sum_{n=0}^{\infty} \frac{x^n}{n!}
            \]
            <i>All derivatives of \( e^x \) are \( e^x \), so at \( x=0 \), each derivative equals 1.</i>
        </div>
        
        <div class="example">
            <b>Example 2: Taylor Series for \( \sin(x) \) at \( a = 0 \)</b><br>
            \[
                \sin(x) = x - \frac{x^3}{3!} + \frac{x^5}{5!} - \frac{x^7}{7!} + \cdots = \sum_{n=0}^{\infty} \frac{(-1)^n x^{2n+1}}{(2n+1)!}
            \]
            <i>The series alternates in sign and only odd powers appear.</i>
        </div>
        
        <div class="example">
            <b>Example 3: Taylor Series for \( \cos(x) \) at \( a = 0 \)</b><br>
            \[
                \cos(x) = 1 - \frac{x^2}{2!} + \frac{x^4}{4!} - \frac{x^6}{6!} + \cdots = \sum_{n=0}^{\infty} \frac{(-1)^n x^{2n}}{(2n)!}
            \]
            <i>Only even powers appear, alternating in sign.</i>
        </div>
        
        <div class="example">
            <b>Example 4: Taylor Series for \( \ln(1+x) \) at \( a = 0 \), \( |x| < 1 \)</b><br>
            \[
                \ln(1+x) = x - \frac{x^2}{2} + \frac{x^3}{3} - \frac{x^4}{4} + \cdots = \sum_{n=1}^{\infty} \frac{(-1)^{n+1} x^n}{n}
            \]
            <i>This series converges for \( |x| < 1 \).</i>
        </div>
        
        <h3>Convergence and Radius of Convergence</h3>
        <p>
            The Taylor series does not always converge to the function for all values of \( x \). The <b>radius of convergence</b> \( R \) determines the interval \( |x-a| < R \) where the series converges to the function.
        </p>
        <ul>
            <li>For \( e^x \): \( R = \infty \) (converges everywhere)</li>
            <li>For \( \sin(x) \) and \( \cos(x) \): \( R = \infty \)</li>
            <li>For \( \ln(1+x) \): \( R = 1 \)</li>
            <li>For \( \frac{1}{1-x} \): \( R = 1 \)</li>
        </ul>
    </div>

    <div id="illustrationSection" class="section" style="display:none;">
        <h2>Interactive Illustration</h2>
        <p>
            Below is an interactive illustration of the Taylor series approximation for various functions at \( a = 0 \) (Maclaurin series):
        </p>
        
        <div class="control-panel">
            <div style="margin-bottom: 25px;">
                <label for="functionSelect">Select Function:</label>
                <select id="functionSelect" onchange="updateTaylor()" style="font-size: 20px; padding: 10px; border: 2px solid #1a73e8; border-radius: 5px; background: white;">
                    <option value="sin">sin(x)</option>
                    <option value="cos">cos(x)</option>
                    <option value="exp">e^x</option>
                    <option value="ln">ln(1+x)</option>
                </select>
            </div>
            <div>
                <label for="order">Taylor Polynomial Order (n):</label>
                <input type="range" id="order" min="1" max="15" value="3" oninput="updateTaylor()">
                <span id="orderValue">3</span>
            </div>
        </div>
        
        <canvas id="taylorCanvas" width="1000" height="500"></canvas>
        
        <div class="example">
            <b>Instructions:</b>
            <ul>
                <li>Select a function from the dropdown menu</li>
                <li>Use the slider to change the order \( n \) of the Taylor polynomial</li>
                <li>Watch how higher-order terms improve the approximation near \( x = 0 \)</li>
                <li>Notice that the approximation gets worse as you move away from the center point \( x = 0 \)</li>
            </ul>
        </div>
        
        <div class="example">
            <b>Visual Elements:</b>
            <ul>
                <li><span style="color: #0074D9;">Blue curve:</span> True function</li>
                <li><span style="color: #FF4136;">Red curve:</span> Taylor polynomial approximation of order \( n \)</li>
                <li><span style="color: #2ECC40;">Green curve:</span> Error = \( |f(x) - P_n(x)| \)</li>
            </ul>
        </div>
    </div>

    <script>
        function getFunction(functionType) {
            switch(functionType) {
                case 'sin': return Math.sin;
                case 'cos': return Math.cos;
                case 'exp': return Math.exp;
                case 'ln': return x => x > -1 ? Math.log(1 + x) : NaN;
                default: return Math.sin;
            }
        }
        
        function getFunctionName(functionType) {
            switch(functionType) {
                case 'sin': return 'sin(x)';
                case 'cos': return 'cos(x)';
                case 'exp': return 'e^x';
                case 'ln': return 'ln(1+x)';
                default: return 'sin(x)';
            }
        }
        
        function taylorSin(x, n) {
            let sum = 0;
            for (let k = 0; k < n; k++) {
                let coeff = (k % 2 === 0 ? 1 : -1);
                sum += coeff * Math.pow(x, 2*k+1) / factorial(2*k+1);
            }
            return sum;
        }
        
        function taylorCos(x, n) {
            let sum = 0;
            for (let k = 0; k < n; k++) {
                let coeff = (k % 2 === 0 ? 1 : -1);
                sum += coeff * Math.pow(x, 2*k) / factorial(2*k);
            }
            return sum;
        }
        
        function taylorExp(x, n) {
            let sum = 0;
            for (let k = 0; k < n; k++) {
                sum += Math.pow(x, k) / factorial(k);
            }
            return sum;
        }
        
        function taylorLn(x, n) {
            if (x <= -1) return NaN;
            let sum = 0;
            for (let k = 1; k <= n; k++) {
                let coeff = (k % 2 === 1 ? 1 : -1);
                sum += coeff * Math.pow(x, k) / k;
            }
            return sum;
        }
        
        function getTaylorFunction(functionType) {
            switch(functionType) {
                case 'sin': return taylorSin;
                case 'cos': return taylorCos;
                case 'exp': return taylorExp;
                case 'ln': return taylorLn;
                default: return taylorSin;
            }
        }
        
        function factorial(n) {
            if (n === 0 || n === 1) return 1;
            let res = 1;
            for (let i = 2; i <= n; i++) res *= i;
            return res;
        }
        
        function updateTaylor() {
            const order = parseInt(document.getElementById('order').value);
            const functionType = document.getElementById('functionSelect').value;
            document.getElementById('orderValue').textContent = order;
            
            const canvas = document.getElementById('taylorCanvas');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Set up coordinate system
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const scaleX = 60; // pixels per unit
            const scaleY = 80; // pixels per unit
            
            // Adjust scale for different functions
            let yScale = scaleY;
            if (functionType === 'exp') {
                yScale = 20; // e^x grows very fast
            }
            
            // Draw grid
            ctx.strokeStyle = '#f0f0f0';
            ctx.lineWidth = 1;
            for (let i = -10; i <= 10; i++) {
                if (i !== 0) {
                    // Vertical lines
                    ctx.beginPath();
                    ctx.moveTo(centerX + i * scaleX, 0);
                    ctx.lineTo(centerX + i * scaleX, canvas.height);
                    ctx.stroke();
                    
                    // Horizontal lines
                    ctx.beginPath();
                    ctx.moveTo(0, centerY + i * yScale);
                    ctx.lineTo(canvas.width, centerY + i * yScale);
                    ctx.stroke();
                }
            }
            
            // Draw axes
            ctx.strokeStyle = '#666';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(0, centerY); 
            ctx.lineTo(canvas.width, centerY); // x-axis
            ctx.moveTo(centerX, 0); 
            ctx.lineTo(centerX, canvas.height); // y-axis
            ctx.stroke();
            
            // Draw axis labels
            ctx.fillStyle = '#000';
            ctx.font = 'bold 16px Arial';
            ctx.textAlign = 'center';
            for (let i = -6; i <= 6; i++) {
                if (i !== 0) {
                    ctx.fillText(i.toString(), centerX + i * scaleX, centerY + 25);
                }
            }
            ctx.textAlign = 'left';
            let yLabelMax = functionType === 'exp' ? 10 : 2;
            for (let i = -yLabelMax; i <= yLabelMax; i++) {
                if (i !== 0) {
                    ctx.fillText(i.toString(), centerX + 8, centerY - i * yScale + 5);
                }
            }
            
            // Get functions
            const originalFunc = getFunction(functionType);
            const taylorFunc = getTaylorFunction(functionType);
            const funcName = getFunctionName(functionType);
            
            // Draw original function
            ctx.strokeStyle = '#0074D9';
            ctx.lineWidth = 3;
            ctx.beginPath();
            let first = true;
            for (let px = 0; px <= canvas.width; px += 2) {
                let x = (px - centerX) / scaleX;
                let y = originalFunc(x);
                
                // Skip invalid values
                if (isNaN(y) || !isFinite(y)) continue;
                
                // Clamp values for display
                if (functionType === 'exp' && Math.abs(y) > 20) continue;
                if (functionType === 'ln' && x <= -1) continue;
                
                let py = centerY - y * yScale;
                
                if (first) {
                    ctx.moveTo(px, py);
                    first = false;
                } else {
                    ctx.lineTo(px, py);
                }
            }
            ctx.stroke();
            
            // Draw Taylor approximation
            ctx.strokeStyle = '#FF4136';
            ctx.lineWidth = 3;
            ctx.beginPath();
            first = true;
            for (let px = 0; px <= canvas.width; px += 2) {
                let x = (px - centerX) / scaleX;
                let y = taylorFunc(x, order);
                
                // Skip invalid values
                if (isNaN(y) || !isFinite(y)) continue;
                
                // Clamp y values to avoid drawing off-screen
                if (Math.abs(y) > (functionType === 'exp' ? 20 : 10)) continue;
                
                let py = centerY - y * yScale;
                
                if (first) {
                    ctx.moveTo(px, py);
                    first = false;
                } else {
                    ctx.lineTo(px, py);
                }
            }
            ctx.stroke();
            
            // Draw error curve
            ctx.strokeStyle = '#2ECC40';
            ctx.lineWidth = 2;
            ctx.beginPath();
            first = true;
            for (let px = 0; px <= canvas.width; px += 2) {
                let x = (px - centerX) / scaleX;
                let originalY = originalFunc(x);
                let taylorY = taylorFunc(x, order);
                
                if (isNaN(originalY) || isNaN(taylorY) || !isFinite(originalY) || !isFinite(taylorY)) continue;
                if (functionType === 'ln' && x <= -1) continue;
                
                let error = Math.abs(originalY - taylorY);
                if (error > (functionType === 'exp' ? 20 : 5)) continue; // Don't draw huge errors
                
                let py = centerY - error * yScale;
                
                if (first) {
                    ctx.moveTo(px, py);
                    first = false;
                } else {
                    ctx.lineTo(px, py);
                }
            }
            ctx.stroke();
            
            // Legend
            ctx.fillStyle = '#0074D9';
            ctx.fillRect(30, 30, 25, 25);
            ctx.fillStyle = '#000';
            ctx.font = 'bold 18px Arial';
            ctx.fillText(funcName, 65, 48);
            
            ctx.fillStyle = '#FF4136';
            ctx.fillRect(30, 65, 25, 25);
            ctx.fillStyle = '#000';
            ctx.fillText('Taylor Polynomial (order ' + order + ')', 65, 83);
            
            ctx.fillStyle = '#2ECC40';
            ctx.fillRect(30, 100, 25, 25);
            ctx.fillStyle = '#000';
            ctx.fillText('|Error|', 65, 118);
        }
        
        function showSection(section) {
            const theorySection = document.getElementById('theorySection');
            const illustrationSection = document.getElementById('illustrationSection');
            const theoryBtn = document.getElementById('theoryBtn');
            const illustrationBtn = document.getElementById('illustrationBtn');
            
            if (section === 'theory') {
                theorySection.style.display = 'block';
                illustrationSection.style.display = 'none';
                theoryBtn.classList.add('active');
                illustrationBtn.classList.remove('active');
            } else {
                theorySection.style.display = 'none';
                illustrationSection.style.display = 'block';
                theoryBtn.classList.remove('active');
                illustrationBtn.classList.add('active');
                // Update the illustration when showing it
                setTimeout(updateTaylor, 100);
            }
        }
        
        // Initialize on page load
        window.onload = function() {
            showSection('theory');
        };
    </script>
</body>
</html>
